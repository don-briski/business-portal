<div class="dt-page__header">
  <h1 class="clearfix dt-page__title">
    Claimed Applications
    <span class="float-right role-add"> </span>
  </h1>
</div>

<!-- Grid -->
<div class="row">
  <!-- Grid Item -->
  <div class="col-xl-12">
    <ul
      id="active-div"
      class="card-header-pills nav nav-pill justify-content-center"
      role="tablist"
    >
      <li
        class="nav-item"
        *ngIf="
          currentuser?.permission?.includes(
            'Claim Applications - Application Pool'
          )
        "
      >
        <a
          (mouseover)="hover_app_open = true"
          (mouseleave)="hover_app_open = false"
          [ngStyle]="
            hover_app_open ? { color: currentTheme?.secondaryColor } : {}
          "
          class="nav-link pool-nav active-tab"
          href="javascript:void(0)"
          (click)="switchviews(1,false,true)"
        >
          Open</a
        >
      </li>
      <li
        class="nav-item"
        *ngIf="
          currentuser?.permission?.includes(
            'Claim Applications - Application Pool'
          )
        "
      >
        <a
          (mouseover)="hover_app_rev = true"
          (mouseleave)="hover_app_rev = false"
          [ngStyle]="
            hover_app_rev ? { color: currentTheme?.secondaryColor } : {}
          "
          class="nav-link pool-nav"
          href="javascript:void(0)"
          (click)="switchviews(2,false,true)"
        >
          Reviewed
        </a>
      </li>
      <li
        class="nav-item"
        *ngIf="
          currentuser?.permission?.includes(
            'Manage All Claimed Applications - Application Pool'
          )
        "
      >
        <a
          (mouseover)="hover_app_all = true"
          (mouseleave)="hover_app_all = false"
          [ngStyle]="
            hover_app_all ? { color: currentTheme?.secondaryColor } : {}
          "
          class="nav-link pool-nav"
          href="javascript:void(0)"
          (click)="switchviews(3,false,true)"
        >
          All Claimed Applications
        </a>
      </li>
    </ul>
    <!-- Card -->
    <div class="dt-card">
      <div
        style="text-align: center"
        *ngIf="
          this.currentview != 1 &&
          this.currentview != 2 &&
          this.currentview != 3
        "
      >
        <br />
        <p style="text-align: center; color: indianred" *ngIf="!requestLoader">
          Click on the indicator tabs above to view content
        </p>
        <a
          *ngIf="!requestLoader"
          class="mt-1 mb-3 btn btn-refresh btn-xs"
          type="button"
          href="javascript:location.reload(true)"
          >Refresh Page</a
        >
      </div>

      <!-- Card Body -->
      <div class="dt-card__body">
        <div
          *ngIf="requestLoader || gettingReviewers"
          class="table-loader"
          [ngClass]="{ 'mb-4': gettingReviewers }"
          style="text-align: center; color: indianred"
        >
          <span> <i class="icon icon-spin icon-spin2"></i> Loading...</span>
        </div>

        <div
          *ngIf="
            this.currentview == 1 &&
            currentuser?.permission?.includes(
              'Claim Applications - Application Pool'
            )
          "
          class="tab-pane"
        >
          <!-- Pagination Top-->
          <div class="row">
            <div class="col-md-8">
              <label style="display: inline-flex"
                ><span style="padding: 8px 2px; font-size: 12px">Show </span
                ><select
                  [(ngModel)]="pagination.pageSize"
                  aria-controls="data-table"
                  (change)="
                    getItemsPaginatedSearch(
                      this.pagination.searchTerm,
                      this.pagination.pageSize,
                      1
                    )
                  "
                  class="custom-select custom-select-xl form-control form-control-xl height"
                >
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
                <span style="padding: 8px 2px; font-size: 12px"
                  >entries</span
                ></label
              >
            </div>
            <div class="form-group col-md-4">
              <lnd-search-dropdown
                [searchColumns]="pagination?.searchColumns"
                (searchParams)="onSearchParams($event)"
              />
            </div>
          </div>
          <div class="mb-3">
            <lnd-filter-selection (filterParams)="setFilterParams($event)" />

          </div>
          <div *ngIf="!requestLoader" class="row">
            <div
              class="col-md-6"
              aria-live="polite"
              style="padding-left: 18px; font-size: 13px; margin-top: -8px"
            >
              Showing {{ (pagination.pageNum - 1) * pagination.pageSize + 1 }} -
              {{
                (pagination.pageNum - 1) * pagination.pageSize +
                  pagination.count
              }}
              of {{ pagination.totalRecords }} record(s)
            </div>
            <div class="col-md-4"></div>
            <div
              class="col-md-2"
              style="margin-top: -8px; display: flex; justify-content: flex-end"
            >
              <lnd-filter-btn
                (filterModalOpen)="filterModalOpen()"
              ></lnd-filter-btn>
            </div>
          </div>

          <!-- /pagination Top -->

          <!-- Tables -->
          <div class="table-responsive">
            <table
              id="table1"
              class="table table-striped table-hover"
              [ngClass]="{ 'table-dark': currentTheme?.theme === 'dark' }"
            >
              <thead>
                <tr>
                  <th>Code</th>
                  <th>Applicant</th>
                  <th class="amount-field">
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                  <th>Date Submitted</th>
                  <th>Date Claimed or Assigned</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let row of applications; let i = index"
                  class="cursor"
                  (click)="getLoanDetailsWithHistoryById(row?.loanId)"
                >
                  <td
                    class="copy_icon_wrapper"
                    [style.color]="currentTheme?.secondaryColor"
                    (click)="customizer()"
                    [style.color]="currentTheme?.secondaryColor"
                  >
                    {{ row?.applicationCode }}
                    <img
                      (mouseover)="copy_hover = true"
                      (mouseleave)="copy_hover = false"
                      class="copy_icon"
                      src="assets/images/copy.png"
                      alt="copy icon"
                      width="15"
                      height="15"
                      (click)="copyCode(row?.applicationCode)"
                      placement="right"
                      ngbTooltip="Copy Application Code"
                    />
                    <span
                      class="circle-buyover circle--one"
                      *ngIf="
                        row?.lendingInstitutionId != null &&
                        row?.lendingInstitutionId != ''
                      "
                    ></span>
                  </td>
                  <td>{{ row?.customerName }}</td>
                  <td class="amount-field">
                    {{ row?.loanAmount | number : "1.2-2" }}
                  </td>
                  <td>{{ row?.createdAt | date : "dd/MM/yyyy" }}</td>
                  <td>{{ row?.dateApproverClaimed | date : "dd/MM/yyyy" }}</td>
                  <td>
                    <span
                      *ngIf="row?.status == 'Claimed'"
                      style="background-color: #453488; color: white"
                      class="mb-1 mr-1 badge badge-warning btn-xs"
                    >
                      {{ row?.status | titlecase }}</span
                    >
                    <span
                      *ngIf="row?.status == 'Redraft'"
                      class="mb-1 mr-1 badge badge-warning btn-xs"
                    >
                      {{ row?.status | titlecase }}
                    </span>
                    <span
                      *ngIf="row?.status == 'Rejected'"
                      class="mb-1 mr-1 badge badge-danger btn-xs"
                    >
                      {{ row?.status | titlecase }}</span
                    >
                    <span
                      *ngIf="
                        row?.status != 'Claimed' &&
                        row?.status != 'Redraft' &&
                        row?.status != 'Rejected'
                      "
                      class="mb-1 mr-1 badge badge-success btn-xs"
                    >
                      Approved</span
                    >
                  </td>
                  <td>
                    <a
                      class="d-inline-block"
                      [style.color]="currentTheme?.secondaryColor"
                      href="javascript:void(0)"
                      ><i class="mr-2 icon icon-forward icon-fw"></i>View</a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- /tables -->

          <!-- Pagination Bottom -->
          <div>
            <br />
            <nav>
              <ul class="pagination pagination-sm justify-content-end">
                <li
                  class="page-item"
                  *ngIf="
                    (pagination.pageNum - 1) * pagination.pageSize + 1 > 10
                  "
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch(
                        this.pagination.searchTerm,
                        this.pagination.pageSize,
                        pagination.pageNum - 1
                      )
                    "
                    tabindex="-1"
                    >Previous</a
                  >
                </li>
                <li class="page-item pagination-menu-wrapper">
                  <a
                    class="page-link page-target"
                    (click)="getItemsPaginatedPageJumpModal()"
                    href="javascript:void(0)"
                    >{{ pagination.pageNum }} of
                    {{ this.pagination.maxPage }} page<span
                      *ngIf="pagination.pageNum > 1"
                      >s</span
                    ><span class="sr-only">(current)</span></a
                  >

                  <div class="pagination-menu pagination-menu-right">
                    <div class="pagination-menu-body">
                      <div class="h-auto">
                        <span>Jump to Page</span>
                        <select
                          aria-controls="data-table"
                          [(ngModel)]="pagination.pageNum"
                          (change)="getApplications(pagination.pageNum)"
                          class="custom-select custom-select-xl form-control form-control-xl height"
                        >
                          <option *ngFor="let line of pagination.jumpArray">
                            {{ line }}
                          </option>
                        </select>
                        <div class="mt-3 text-center">
                          <button
                            type="button"
                            (click)="getItemsPaginatedPageJumpModal()"
                            class="btn btn-danger btn-xs"
                          >
                            Close
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li
                  class="page-item"
                  *ngIf="this.pagination.pageNum < this.pagination.maxPage"
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch(
                        this.pagination.searchTerm,
                        this.pagination.pageSize,
                        pagination.pageNum + 1
                      )
                    "
                    >Next</a
                  >
                </li>
              </ul>
            </nav>
          </div>
          <!-- /pagination Bottom -->
        </div>

        <div
          *ngIf="
            this.currentview == 2 &&
            currentuser?.permission?.includes(
              'Claim Applications - Application Pool'
            )
          "
          class="tab-pane"
        >
          <!-- Pagination Top-->
          <div class="row mb-4">
            <div class="col-md-4">
              <label style="display: inline-flex"
                ><span style="padding: 8px 2px; font-size: 12px">Show </span
                ><select
                  [(ngModel)]="pagination2.pageSize"
                  aria-controls="data-table"
                  (change)="
                    getItemsPaginatedSearch2(
                      this.pagination2.searchTerm,
                      this.pagination2.pageSize,
                      1
                    )
                  "
                  class="custom-select custom-select-xl form-control form-control-xl height"
                >
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
                <span style="padding: 8px 2px; font-size: 12px"
                  >entries</span
                ></label
              >
            </div>
            <div class="col-md-4">
              <div
                class="text-center"
                *ngIf="
                  currentuser?.permission?.includes(
                    'Recall Loan Application'
                  ) && !requestLoader
                "
              >
                <button
                  class="btn btn-xs btn-primary"
                  (click)="toggleRecallLoansCheck()"
                  *ngIf="!recallMultiLoans"
                >
                  Recall Loan(s)
                </button>
                <button
                  class="mr-2 btn btn-xs btn-success"
                  (click)="callRecallMultiLoansPin(multiRecallModal)"
                  *ngIf="loansToRecall.length > 0"
                >
                  Recall Selected Loans
                </button>
                <button
                  class="btn btn-xs btn-danger"
                  (click)="toggleRecallLoansCheck()"
                  *ngIf="recallMultiLoans"
                >
                  Cancel Multiple Loans
                </button>
                <p class="mt-2 text-muted" *ngIf="recallMultiLoans">
                  <small
                    >Please note that, loans without checkbox cannot be
                    recalled.</small
                  >
                </p>
              </div>
            </div>
            <div class="form-group col-md-4">
              <lnd-search-dropdown
                [searchColumns]="pagination?.searchColumns"
                (searchParams)="onSearchParams($event)"
              />
            </div>
          </div>
          <!-- reviewed -->

          <lnd-filter-selection (filterParams)="setFilterParams($event)" />

          <div class="row">
            <div
              class="col-md-6"
              aria-live="polite"
              style="padding-left: 18px; font-size: 13px; margin-top: -8px"
            >
              Showing
              {{ (pagination2.pageNum - 1) * pagination2.pageSize + 1 }} -
              {{
                (pagination2.pageNum - 1) * pagination2.pageSize +
                  pagination2.count
              }}
              of {{ pagination2.totalRecords }} record(s)
            </div>

            <div class="col-md-4"></div>
            <div
              class="col-md-2"
              style="margin-top: -8px; display: flex; justify-content: flex-end"
            >
            <lnd-filter-btn (filterModalOpen)="filterModalOpen()"/>
            </div>
          </div>

          <!-- /pagination Top -->

          <!-- Tables -->
          <div class="table-responsive">
            <table
              id="table1"
              class="table"
              [ngClass]="
                currentTheme?.theme === 'Dark'
                  ? ''
                  : 'table-striped table-hover'
              "
            >
              <thead>
                <tr>
                  <th *ngIf="recallMultiLoans"></th>
                  <th>Code</th>
                  <th>Applicant</th>
                  <th class="amount-field">
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                  <th>Date Submitted</th>
                  <th>Date Approved</th>
                  <th>Stage</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let row of reviewedapplications; let i = index"
                  class="cursor"
                  (click)="getLoanDetailsWithHistoryById(row?.loanId)"
                >
                  <td *ngIf="recallMultiLoans">
                    <span
                      *ngIf="
                        row?.status != 'Claimed' &&
                        row?.status != 'Redraft' &&
                        row?.status != 'Rejected' &&
                        row?.status != 'Deactivated' &&
                        row?.status != 'Disbursed' &&
                        row?.status != 'Settled' &&
                        row?.status != 'Paid' &&
                        row?.status != 'DisbursementRequestSent' &&
                        row?.status != 'DisbursementFailed'
                      "
                    >
                      <!-- <span> -->
                      <input
                        type="checkbox"
                        (change)="toggleLoansToRecall($event)"
                        [value]="row?.loanId"
                      />
                    </span>
                  </td>
                  <td
                    class="copy_icon_wrapper"
                    [style.color]="currentTheme?.secondaryColor"
                    (click)="customizer()"
                    [style.color]="currentTheme?.secondaryColor"
                  >
                    {{ row?.applicationCode }}
                    <img
                      (mouseover)="copy_hover = true"
                      (mouseleave)="copy_hover = false"
                      class="copy_icon"
                      src="assets/images/copy.png"
                      alt="copy icon"
                      width="15"
                      height="15"
                      (click)="copyCode(row?.applicationCode)"
                      placement="right"
                      ngbTooltip="Copy Application Code"
                    />
                    <span
                      class="circle-buyover circle--one"
                      *ngIf="
                        row?.lendingInstitutionId != null &&
                        row?.lendingInstitutionId != ''
                      "
                    ></span>
                  </td>
                  <td>{{ row?.customerName }}</td>
                  <td class="amount-field">
                    {{ row?.loanAmount | number : "1.2-2" }}
                  </td>
                  <td>{{ row?.createdAt | date : "dd/MM/yyyy" }}</td>
                  <td>{{ row?.dateApproverApproved | date : "dd/MM/yyyy" }}</td>
                  <td>
                    <span
                      *ngIf="
                        row?.status == 'Disbursed' ||
                        row?.status == 'Settled' ||
                        row?.status == 'Paid'
                      "
                      class="mb-1 mr-1 badge badge-success btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}</span
                    >

                    <span
                      *ngIf="
                        row?.status != 'Rejected' &&
                        row?.status != 'Deactivated' &&
                        row?.status != 'DisbursementFailed' &&
                        row?.status != 'Disbursed' &&
                        row?.status != 'Settled' &&
                        row?.status != 'Paid'
                      "
                      class="mb-1 mr-1 badge badge-warning btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}
                    </span>
                    <span
                      *ngIf="
                        row?.status == 'Rejected' ||
                        row?.status == 'Deactivated' ||
                        row?.status == 'DisbursementFailed'
                      "
                      class="mb-1 mr-1 badge badge-danger btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}</span
                    >
                  </td>
                  <td>
                    <a
                      class="d-inline-block"
                      [style.color]="currentTheme?.secondaryColor"
                      href="javascript:void(0)"
                      ><i class="mr-2 icon icon-forward icon-fw"></i>View</a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- /tables -->

          <!-- Pagination Bottom -->
          <div>
            <br />
            <nav>
              <ul class="pagination pagination-sm justify-content-end">
                <li
                  class="page-item"
                  *ngIf="
                    (pagination2.pageNum - 1) * pagination2.pageSize + 1 > 10
                  "
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch2(
                        this.pagination2.searchTerm,
                        this.pagination2.pageSize,
                        pagination2.pageNum - 1
                      )
                    "
                    tabindex="-1"
                    >Previous</a
                  >
                </li>
                <li class="page-item pagination-menu-wrapper">
                  <a
                    class="page-link page-target"
                    (click)="getItemsPaginatedPageJumpModal()"
                    href="javascript:void(0)"
                    >{{ pagination2.pageNum }} of
                    {{ this.pagination2.maxPage }} page<span
                      *ngIf="pagination2.pageNum > 1"
                      >s</span
                    ><span class="sr-only">(current)</span></a
                  >

                  <div class="pagination-menu pagination-menu-right">
                    <div class="pagination-menu-body">
                      <div class="h-auto">
                        <span>Jump to Page</span>
                        <select
                          aria-controls="data-table"
                          [(ngModel)]="pagination2.pageNum"
                          (change)="
                            getReviewedApplications(pagination2.pageNum)
                          "
                          class="custom-select custom-select-xl form-control form-control-xl height"
                        >
                          <option *ngFor="let line of pagination2.jumpArray">
                            {{ line }}
                          </option>
                        </select>
                        <div class="mt-3 text-center">
                          <button
                            type="button"
                            (click)="getItemsPaginatedPageJumpModal()"
                            class="btn btn-danger btn-xs"
                          >
                            Close
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li
                  class="page-item"
                  *ngIf="this.pagination2.pageNum < this.pagination2.maxPage"
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch2(
                        this.pagination2.searchTerm,
                        this.pagination2.pageSize,
                        pagination2.pageNum + 1
                      )
                    "
                    >Next</a
                  >
                </li>
              </ul>
            </nav>
          </div>
          <!-- /pagination Bottom -->
        </div>

        <div
          *ngIf="
            this.currentview === 3 &&
            currentuser?.permission?.includes(
              'Manage All Claimed Applications - Application Pool'
            )
          "
          class="tab-pane"
        >
          <!-- Pagination Top-->
          <div class="row">
            <div class="col-md-4">
              <label style="display: inline-flex"
                ><span style="padding: 8px 2px; font-size: 12px">Show </span
                ><select
                  [(ngModel)]="pagination3.pageSize"
                  aria-controls="data-table"
                  (change)="
                    getItemsPaginatedSearch3(
                      this.pagination3.searchTerm,
                      this.pagination3.pageSize,
                      1
                    )
                  "
                  class="custom-select custom-select-xl form-control form-control-xl height"
                >
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
                <span style="padding: 8px 2px; font-size: 12px"
                  >entries</span
                ></label
              >
            </div>
            <div class="col-md-4 text-center">
              <button
                class="mr-2 btn btn-xs btn-primary"
                (click)="confirmApplicationResend()"
                *ngIf="claimedApplicationSelection.selected.length > 0"
                [disabled]="loader"
              >
                <i class="icon icon-spin icon-spin2" *ngIf="loader"></i>
                {{ loader ? "Sending to pool..." : "Send back to pool" }}
              </button>
              <button
                class="mr-2 btn btn-xs btn-query"
                (click)="
                  onReassignReviewer(
                    reAssignReviewerModal,
                    loanReassignmentErrorView
                  )
                "
                *ngIf="claimedApplicationSelection.selected.length > 0"
              >
                Re-assign reviewer
              </button>
            </div>
            <div class="form-group col-md-4">
              <lnd-search-dropdown
                [searchColumns]="pagination?.searchColumns"
                (searchParams)="onSearchParams($event)"
              />
            </div>
          </div>
          <div class="mb-3">
            <lnd-filter-selection (filterParams)="setFilterParams($event)" />
          </div>
          <!-- reviewed -->
          <div *ngIf="!requestLoader" class="row">
            <div
              class="col-md-6 pt-3"
              aria-live="polite"
              style="padding-left: 18px; font-size: 13px; margin-top: -8px"
            >
              Showing
              {{ (pagination3.pageNum - 1) * pagination3.pageSize + 1 }} -
              {{
                (pagination3.pageNum - 1) * pagination3.pageSize +
                  pagination3.count
              }}
              of {{ pagination3.totalRecords }} record(s)
            </div>

            <div class="col-md-4"></div>
            <div
              class="col-md-2"
              style="margin-top: -8px; display: flex; justify-content: flex-end"
            >
              <lnd-filter-btn
                (filterModalOpen)="filterModalOpen()"
              ></lnd-filter-btn>
            </div>
          </div>

          <!-- /pagination Top -->

          <!-- Tables -->
          <div class="table-responsive">
            <table
              id="table1"
              class="table"
              [ngClass]="
                currentTheme?.theme === 'Dark'
                  ? ''
                  : 'table-striped table-hover'
              "
            >
              <thead>
                <tr>
                  <th>
                    <input
                      type="checkbox"
                      [checked]="isAllClaimedAppSelected()"
                      (change)="masterToggle()"
                      [indeterminate]="isAllClaimedAppIndeterminate()"
                    />
                  </th>
                  <th>Code</th>
                  <th>Applicant</th>
                  <th>Current Underwriter</th>
                  <th class="amount-field">
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                  <th>Date Submitted</th>
                  <th>Date Approved</th>
                  <th>Stage</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let row of allClaimedApplications; let i = index"
                  class="cursor"
                >
                  <td>
                    <span class="d-flex align-items-center">
                      <input
                        type="checkbox"
                        [value]="row?.loanId"
                        (change)="toggleClaimedLoan(row)"
                        [checked]="claimedApplicationSelection.isSelected(row)"
                      />
                      <img
                        *ngIf="row.isMultiLevelLoanApproval"
                        class="arrow-icon ml-1"
                        src="assets/images/arrow-left-right.svg"
                        alt="Arrow Icon"
                        placement="top"
                        ngbTooltip="This loan requires multi-level approval."
                      />
                    </span>
                  </td>
                  <td
                    (click)="getLoanDetailsWithHistoryById(row?.loanId)"
                    [style.color]="currentTheme?.secondaryColor"
                    [style.color]="currentTheme?.secondaryColor"
                    class="copy_icon_wrapper"
                  >
                    {{ row?.applicationCode }}
                    <img
                      (mouseover)="copy_hover = true"
                      (mouseleave)="copy_hover = false"
                      class="copy_icon"
                      src="assets/images/copy.png"
                      alt="copy icon"
                      width="15"
                      height="15"
                      (click)="copyCode(row?.applicationCode)"
                      placement="right"
                      ngbTooltip="Copy Application Code"
                    />
                    <span
                      class="circle-buyover circle--one"
                      *ngIf="
                        row?.lendingInstitutionId != null &&
                        row?.lendingInstitutionId != ''
                      "
                    ></span>
                  </td>
                  <td (click)="getLoanDetailsWithHistoryById(row?.loanId)">
                    {{ row?.applicantName }}
                  </td>
                  <td>{{ row?.reviewerName }}</td>
                  <td
                    (click)="getLoanDetailsWithHistoryById(row?.loanId)"
                    class="amount-field"
                  >
                    {{ row?.loanAmount | number : "1.2-2" }}
                  </td>
                  <td (click)="getLoanDetailsWithHistoryById(row?.loanId)">
                    {{ row?.dateSubmitted | date : "dd/MM/yyyy" }}
                  </td>
                  <td (click)="getLoanDetailsWithHistoryById(row?.loanId)">
                    {{ row?.dateApproved | date : "dd/MM/yyyy" }}
                  </td>
                  <td (click)="getLoanDetailsWithHistoryById(row?.loanId)">
                    <span
                      *ngIf="
                        row?.status == 'Disbursed' || row?.status == 'Settled'
                      "
                      class="mb-1 mr-1 badge badge-success btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}</span
                    >

                    <span
                      *ngIf="
                        row?.status != 'Rejected' &&
                        row?.status != 'Deactivated' &&
                        row?.status != 'DisbursementFailed' &&
                        row?.status != 'Disbursed' &&
                        row?.status != 'Settled'
                      "
                      class="mb-1 mr-1 badge badge-warning btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}
                    </span>
                    <span
                      *ngIf="
                        row?.status == 'Rejected' ||
                        row?.status == 'Deactivated' ||
                        row?.status == 'DisbursementFailed'
                      "
                      class="mb-1 mr-1 badge badge-danger btn-xs"
                    >
                      {{ row?.loanStage | titlecase }}</span
                    >
                  </td>
                  <td (click)="getLoanDetailsWithHistoryById(row?.loanId)">
                    <a
                      class="d-inline-block"
                      [style.color]="currentTheme?.secondaryColor"
                      href="javascript:void(0)"
                      ><i class="mr-2 icon icon-forward icon-fw"></i>View</a
                    >
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- /tables -->

          <!-- Pagination Bottom -->
          <div>
            <br />
            <nav>
              <ul class="pagination pagination-sm justify-content-end">
                <li
                  class="page-item"
                  *ngIf="
                    (pagination3.pageNum - 1) * pagination3.pageSize + 1 > 10
                  "
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch3(
                        this.pagination3.searchTerm,
                        this.pagination3.pageSize,
                        pagination3.pageNum - 1
                      )
                    "
                    tabindex="-1"
                    >Previous</a
                  >
                </li>
                <li class="page-item pagination-menu-wrapper">
                  <a
                    class="page-link page-target"
                    (click)="getItemsPaginatedPageJumpModal()"
                    href="javascript:void(0)"
                    >{{ pagination3.pageNum }} of
                    {{ this.pagination3.maxPage }} page<span
                      *ngIf="pagination3.pageNum > 1"
                      >s</span
                    ><span class="sr-only">(current)</span></a
                  >

                  <div class="pagination-menu pagination-menu-right">
                    <div class="pagination-menu-body">
                      <div class="h-auto">
                        <span>Jump to Page</span>
                        <select
                          aria-controls="data-table"
                          [(ngModel)]="pagination3.pageNum"
                          (change)="
                            getAllClaimedApplications(pagination3.pageNum)
                          "
                          class="custom-select custom-select-xl form-control form-control-xl height"
                        >
                          <option *ngFor="let line of pagination3.jumpArray">
                            {{ line }}
                          </option>
                        </select>
                        <div class="mt-3 text-center">
                          <button
                            type="button"
                            (click)="getItemsPaginatedPageJumpModal()"
                            class="btn btn-danger btn-xs"
                          >
                            Close
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </li>
                <li
                  class="page-item"
                  *ngIf="this.pagination3.pageNum < this.pagination3.maxPage"
                >
                  <a
                    class="page-link"
                    href="javascript:void(0)"
                    (click)="
                      getItemsPaginatedSearch3(
                        this.pagination3.searchTerm,
                        this.pagination3.pageSize,
                        pagination3.pageNum + 1
                      )
                    "
                    >Next</a
                  >
                </li>
              </ul>
            </nav>
          </div>
          <!-- /pagination Bottom -->
        </div>
      </div>
    </div>
  </div>
</div>
<aside class="dt-customizer dt-drawer position-right">
  <div *ngIf="viewloandetails" class="dt-customizer__inner">
    <div class="dt-customizer__header shadow-none border-bottom">
      <div class="dt-avatar-wrapper">
        <img
          class="dt-avatar size-75 mr-sm-4"
          [src]="loanInformation?.customerImageUrl"
          alt="Default"
        />
        <div class="dt-avatar-info">
          <div class="display-5 mb-2 font-weight-bold">
            {{ loanInformation?.person?.displayName }}
          </div>
          <div class="f-12 flex">
            <span class="code mr-2">
              {{ loanInformation?.applicationCode }}</span
            >

            <span
              *ngIf="loanInformation?.statusString == 'Claimed'"
              class="mb-1 mr-1 badge badge-warning btn-xs"
              ><i class="icon icon-mail-open"></i>
              {{ loanInformation?.statusString }}</span
            >
            <span
              *ngIf="loanInformation?.statusString == 'Redraft'"
              class="mb-1 mr-1 badge badge-warning btn-xs"
            >
              {{ loanInformation?.statusString }}
            </span>
            <span
              *ngIf="
                loanInformation?.statusString == 'Rejected' ||
                loanInformation?.statusString == 'Deactivated'
              "
              class="mb-1 mr-1 badge badge-danger btn-xs"
            >
              {{ loanInformation?.statusString }}</span
            >
            <span
              *ngIf="
                loanInformation?.statusString != 'Claimed' &&
                loanInformation?.statusString != 'Redraft' &&
                loanInformation?.statusString != 'Rejected' &&
                loanInformation?.statusString != 'Deactivated'
              "
              class="mb-1 mr-1 badge badge-success btn-xs"
            >
              <i class="icon icon-circle-check-o"></i> Approved</span
            >
          </div>
          <span
            ><span *ngIf="loanInformation?.person?.emailAddress != null">
              <i class="mr-3 icon icon-email icon-xl"></i>&nbsp;
              {{ loanInformation?.person?.emailAddress }}</span
            >
            &nbsp;&nbsp;<span *ngIf="loanInformation?.person?.phoneNumber">
              <i class="mr-3 icon icon-phone icon-xl"></i> &nbsp;{{
                loanInformation?.person?.phoneNumber
              }}
            </span>
            <small *ngIf="loanInformation?.parentLoanId != null" class="notify">
              Loan Top-Up Application for running Loan:
              {{ getFromJson(loanInformation?.loanTypeInfo, "parentLoanCode") }}
              ({{ ownerInformation?.currency?.currencySymbol
              }}{{
                getFromJson(loanInformation?.loanTypeInfo, "parentLoanAmount")
                  | number : "1.2-2"
              }})
            </small>
          </span>
        </div>
      </div>
      <button type="button" class="close" (click)="closeAside()">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="dt-customizer__body ps-custom-scrollbar">
      <section *ngIf="isMultiLevelApproval" id="loan-approval-flow">
        <h5 class="mt-5 mb-3">Loan Approval Flow</h5>
        <div class="row">
          <div
            *ngFor="let approval of loanWithApprovalWorkflow.approvalFlow"
            class="col-md-3"
          >
            <lnd-loan-approval-workflow-update
              [level]="approval.level"
              [status]="approval.status"
            >
            </lnd-loan-approval-workflow-update>
          </div>
        </div>
      </section>
      <div class="row">
        <div class="col-md-12" style="padding: 20px">
          <ul class="dt-list dt-list-one-second padded-left">
            <li class="dt-list__item">
              <div class="media">
                <i
                  class="mr-3 icon icon-revenue-new icon-3x align-self-center text-warning"
                ></i>
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Amount Requested</span
                  >
                  <h5 class="mb-0">
                    <b
                      >{{ ownerInformation?.currency?.currencySymbol
                      }}{{ loanInformation?.loanAmount | number : "1.2-2" }}</b
                    >
                  </h5>
                </div>
              </div>
            </li>
            <li
              class="dt-list__item"
              *ngIf="
                !isEmpty(loanInformation?.loanTypeInfo) &&
                !isEmpty(
                  getFromJson(loanInformation?.loanTypeInfo, 'loanTypeName')
                )
              "
            >
              <div class="media">
                <i
                  class="mr-3 icon icon-editor icon-3x align-self-center text-warning"
                ></i>
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Loan Type</span
                  >
                  <h5 class="mb-0">
                    {{
                      getFromJson(loanInformation?.loanTypeInfo, "loanTypeName")
                    }}
                  </h5>
                </div>
              </div>
            </li>
            <lnd-loan-deposit-card
              [loanDeposit]="loanInformation?.loanDeposit"
              [currentTheme]="currentTheme"
            ></lnd-loan-deposit-card>
            <li
              class="dt-list__item"
              *ngIf="
                !isEmpty(loanInformation?.loanTypeInfo) &&
                !isEmpty(
                  getFromJson(loanInformation?.loanTypeInfo, 'loanInterestRate')
                )
              "
            >
              <div class="media">
                <i
                  class="mr-3 icon icon-editor icon-3x align-self-center text-warning"
                ></i>
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Loan Interest Rate</span
                  >
                  <h5 class="mb-0" style="position: relative">
                    <span *ngIf="!changeInterest">
                      {{
                        getFromJson(
                          loanInformation?.loanTypeInfo,
                          "loanInterestRate"
                        )
                      }}
                    </span>
                    <span class="mr-1" style="position: relative">
                      <input
                        type="text"
                        value="{{
                          getFromJson(
                            loanInformation?.loanTypeInfo,
                            'loanInterestRate'
                          )
                        }}"
                        *ngIf="changeInterest"
                        style="width: 90px; border: 1px solid lightgrey"
                        (change)="updateInterestRate($event.target.value)"
                        [disabled]="updateLoanInterestLoader"
                      />

                      <span
                        [style.color]="currentTheme?.secondaryColor"
                        *ngIf="updateLoanInterestLoader"
                        class="icon icon-spin icon-spin2"
                        style="position: absolute; right: 15px; top: 2px"
                      ></span>
                    </span>
                    <a
                      href="javascript:;"
                      *ngIf="
                        currentuser?.permission?.includes(
                          'Override Loan Product Interest Rate'
                        ) && !updateLoanInterestLoader
                      "
                      (click)="changeInterest = !changeInterest"
                    >
                      <i class="mb-1 icon icon-edit"></i>
                    </a>
                  </h5>
                </div>
              </div>
            </li>
            <li class="dt-list__item">
              <div class="media">
                <i
                  class="mr-3 icon icon-datepicker icon-2x align-self-center text-warning"
                ></i>
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12">Tenor</span>
                  <h5 class="mb-0">
                    {{ loanInformation?.loanTenor }}
                    {{ loanInformation?.repaymentScheduleType
                    }}{{ loanInformation?.loanTenor === 1 ? "" : "s" }}
                  </h5>
                </div>
              </div>
            </li>
            <li
              class="dt-list__item"
              *ngIf="loanInformation?.employmentInfo != null"
            >
              <div class="media">
                <i
                  class="mr-3 icon icon-company icon-3x align-self-center text-warning"
                ></i>

                <!-- Media Body -->
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Net Income</span
                  >
                  <h5 class="mb-0">
                    {{ ownerInformation?.currency?.currencySymbol }}
                    {{
                      getFromJson(loanInformation?.employmentInfo, "netIncome")
                        | number : "1.2-2"
                    }}
                  </h5>
                </div>
              </div>
            </li>
            <li
              class="dt-list__item"
              *ngIf="
                !isEmpty(loanInformation?.repaymentInfo) &&
                !isEmpty(
                  getFromJson(loanInformation?.repaymentInfo, 'repaymentMethod')
                )
              "
            >
              <div class="media">
                <i
                  class="mr-3 icon icon-card icon-2x align-self-center text-warning"
                ></i>
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Repayment Method</span
                  >
                  <h5 class="mb-0">
                    {{
                      getFromJson(
                        loanInformation?.repaymentInfo,
                        "repaymentMethod"
                      )
                    }}
                  </h5>
                </div>
                <!-- /media body -->
              </div>
              <!-- /media -->
            </li>
            <li
              class="dt-list__item"
              *ngIf="!isEmpty(loanInformation?.user?.person?.displayName)"
            >
              <!-- Media -->
              <div class="media">
                <i
                  class="mr-3 icon icon-user-o icon-3x align-self-center text-warning"
                ></i>

                <!-- Media Body -->
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Created by</span
                  >
                  <h5 class="mb-0">
                    {{ loanInformation?.user?.person?.displayName }}
                  </h5>
                </div>
                <!-- /media body -->
              </div>
              <!-- /media -->
            </li>
            <!-- /list item -->

            <li
              class="dt-list__item"
              *ngIf="
                !isEmpty(loanInformation?.salesPerson?.person?.displayName)
              "
            >
              <!-- Media -->
              <div class="media">
                <i
                  class="mr-3 icon icon-user-o icon-3x align-self-center text-warning"
                ></i>

                <!-- Media Body -->
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Sales Person</span
                  >
                  <h5 class="mb-0">
                    {{ loanInformation?.salesPerson?.person?.displayName }}
                  </h5>
                </div>
                <!-- /media body -->
              </div>
              <!-- /media -->
            </li>

            <li
              class="dt-list__item"
              *ngIf="
                !isEmpty(loanInformation?.loanStartDate) &&
                currentuser?.permission?.includes(
                  'Set Loan Application Start Date'
                )
              "
            >
              <!-- Media -->
              <div class="media">
                <i
                  class="mr-3 icon icon-datepicker icon-3x align-self-center text-warning"
                ></i>

                <!-- Media Body -->
                <div class="media-body">
                  <span class="mb-1 d-block text-light-gray f-12"
                    >Loan Start Date</span
                  >
                  <h5 class="mb-0">
                    {{ loanInformation?.loanStartDate | date : "mediumDate" }}
                  </h5>
                </div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="d-flex align-items-center ml-3 p-3 mb-5">
        <div class="mr-3">
          <button
            *ngIf="!repaymentLoader"
            type="button"
            class="btn btn-primary"
            (click)="viewRepaymentSchedule(repaymentSchedule)"
          >
            View Repayment Schedule
          </button>
          <button
            *ngIf="repaymentLoader"
            type="button"
            class="btn btn-primary"
            [disabled]="true"
          >
            <i class="icon icon-spin icon-spin2"></i>
            Processing ...
          </button>
          <button
            *ngIf="isMultiLevelApproval"
            type="button"
            class="btn btn-outline-primary ml-3"
            (click)="onOpenEditModal(editLoanAppInfoView)"
          >
            Edit Loan Application
          </button>
        </div>
        <div
          class="mr-3"
          *ngIf="
            currentuser?.permission?.includes('Recall Loan Application') &&
            !requestLoader &&
            loanInformation?.statusString != 'Claimed' &&
            loanInformation?.statusString != 'Redraft' &&
            loanInformation?.statusString != 'Rejected' &&
            loanInformation?.statusString != 'Deactivated' &&
            loanInformation?.statusString != 'Disbursed' &&
            loanInformation?.statusString != 'Settled' &&
            loanInformation?.statusString != 'DisbursementFailed'
          "
        >
          <button class="btn btn-primary" (click)="recallLoan(recallModal)">
            Recall Loan
          </button>
        </div>
      </div>
      <div class="">
        <br />
        <div class="dt-card__body">
          <form
            [formGroup]="AddResponseForm"
            (keydown.enter)="$event.preventDefault()"
            (ngSubmit)="submitResponseForm(AddResponseForm.value)"
          >
            <ul
              class="flex-row nav nav-underline border-bottom nav-card-tabs w-100"
              role="tablist"
            >
              <li class="nav-item">
                <a
                  id="default-nav"
                  class="nav-link active"
                  data-toggle="tab"
                  href="#tab-pane1"
                  role="tab"
                  aria-controls="tab-pane1"
                  class="nav-link"
                  aria-selected="true"
                  >Application Information</a
                >
              </li>
              <li
                class="nav-item"
                *ngIf="
                  appOwnerDetails.decideInfo.isActive ||
                  remitaInflightInUse ||
                  canUseCrc()
                "
              >
                <a
                  class="nav-link"
                  data-toggle="tab"
                  href="#tab-bankStatementAnalysis"
                  (click)="showBankStatementAnalysis = true"
                  role="tab"
                  aria-controls="tab-pane3"
                  class="nav-link"
                  aria-selected="true"
                  ><span class="d-flex"
                    ><span class="mr-1">Third Party Analysis</span>
                    <span
                      *ngIf="remitaInflightInUse"
                      class="ripple"
                    ></span></span
                ></a>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  data-toggle="tab"
                  href="#tab-pane2"
                  role="tab"
                  aria-controls="tab-pane2"
                  class="nav-link"
                  aria-selected="true"
                  >History</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  (click)="
                    submitLoanRequest(
                      'LoanActivities',
                      loanInformation?.loanId,
                      loanInformation?.applicationCode
                    )
                  "
                  data-toggle="tab"
                  href="#tab-pane7"
                  role="tab"
                  aria-controls="tab-pane7"
                  class="nav-link"
                  aria-selected="true"
                  >Comments & Activities</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  data-toggle="tab"
                  href="#tab-pane6"
                  role="tab"
                  aria-controls="tab-pane6"
                  class="nav-link"
                  aria-selected="true"
                  >Documents</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  data-toggle="tab"
                  href="#tab-pane4"
                  role="tab"
                  aria-controls="tab-pane3"
                  (mouseover)="hover_app_rc = true"
                  (mouseleave)="hover_app_rc = false"
                  [ngStyle]="
                    hover_app_rc ? { color: currentTheme?.secondaryColor } : {}
                  "
                  aria-selected="true"
                  >Reviewer Comments</a
                >
              </li>
            </ul>

            <div class="tab-content">
              <div id="tab-pane1" class="tab-pane active">
                <div class="row">
                  <div class="col-xl-12">
                    <div id="account-tab" class="mb-5 border-bottom">
                      <div
                        class="h4 my-5"
                        [style.color]="currentTheme?.secondaryColor"
                      >
                        Personal Information
                      </div>
                      <ul class="dt-list dt-list-one-third">
                        <li class="dt-list__item" *ngIf="bvnInfo?.bvnNumber">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-link icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <div class="d-flex">
                                <span
                                  class="mb-1 mr-2 d-block text-light-gray f-12"
                                  >BVN</span
                                >
                                <lnd-check-icon
                                  *ngIf="bvnInfo?.IsBvnValidated"
                                  tooltip="BVN was validated during loan creation."
                                ></lnd-check-icon>
                              </div>
                              <h5 class="mb-0">{{ bvnInfo.bvnNumber }}</h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li class="dt-list__item" *ngIf="bvnInfo?.bvnDOB">
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-birthday-new icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >DOB (BVN)</span
                              >
                              <h5 class="mb-0">
                                {{ bvnInfo.bvnDOB | date : "mediumDate" }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="bvnInfo?.bvnPhoneNumber"
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Phone (BVN)</span
                              >
                              <h5 class="mb-0">
                                {{ bvnInfo.bvnPhoneNumber }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(loanInformation?.bankInfo, 'bankName')
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Bank</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.bankInfo,
                                    "bankName"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.bankInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.bankInfo,
                                'bankAccountNumber'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Account Number</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.bankInfo,
                                    "bankAccountNumber"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.bankInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.bankInfo,
                                'bankAccountName'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Account Name</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.bankInfo,
                                    "bankAccountName"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="!isEmpty(loanInformation?.person?.sex)"
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Gender</span
                              >
                              <h5 class="mb-0">
                                {{ loanInformation?.person?.sex }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'customerPhoneNumber'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Customer Phone Number</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "customerPhoneNumber"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'customerAltPhoneNumber'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Alt. Phone Number</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "customerAltPhoneNumber"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->
                        <!-- /list item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'address'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-home icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Lives in</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "address"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'nextOfKinName'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Next of Kin Name</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "nextOfKinName"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'nextOfKinPhoneNumber'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Next of Kin Phone Number</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "nextOfKinPhoneNumber"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.residentialInfo,
                                'nextOfKinAddress'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-home icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Next of Kin Address</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.residentialInfo,
                                    "nextOfKinAddress"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              loanInformation?.loanTypeInfo?.loanReasonCode
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-link icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Loan Reason</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.loanTypeInfo,
                                    "loanReasonCode"
                                  )
                                }}:
                                {{
                                  getFromJson(
                                    loanInformation?.loanTypeInfo,
                                    "loanReasonName"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->
                      </ul>
                    </div>

                    <div id="employ-tab" class="mb-5 border-bottom">
                      <div
                        class="h4 my-5"
                        [style.color]="currentTheme?.secondaryColor"
                      >
                        Employment Information
                      </div>
                      <div
                        *ngIf="
                          getFromJson(
                            loanInformation?.repaymentInfo,
                            'repaymentMethod'
                          ) == 'Deduction At Source'
                        "
                      >
                        <span class="text-center"
                          >*Repayment method for applicant is:
                          <span style="color: red">{{
                            getFromJson(
                              loanInformation?.repaymentInfo,
                              "repaymentMethod"
                            )
                          }}</span></span
                        >
                        <br />
                        <br />
                      </div>

                      <div
                        *ngIf="
                          loanInformation?.employerVerified == false &&
                          loanInformation?.employmentInfo != null
                        "
                        class="text-center"
                      >
                        <img
                          style="width: 25px"
                          src="assets/images/not-verified1.png"
                          alt="Default"
                        />&nbsp;
                        <span
                          ><b>
                            {{
                              getFromJson(
                                loanInformation?.employmentInfo,
                                "employerName"
                              )
                            }}</b
                          >
                          is not verified, you will not be allowed to
                          proceed.</span
                        >
                        <br />
                        <br />
                        <br />
                      </div>

                      <!-- List -->
                      <ul class="dt-list dt-list-one-third">
                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employmentStatus'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-stats icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Employment Status</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employmentStatus"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Works at</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employerName"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->
                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employmentIndustry'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Industry</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employmentIndustry"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employmentCode'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user-o icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Employment ID/Code</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employmentCode"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employerAddress'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-geo-location icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Address</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employerAddress"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employmentYears'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-contacts icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Date of Employment</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employmentYears"
                                  )
                                }}
                                <small>
                                  ({{
                                    getFullDateDiff(
                                      loanInformation?.createdAt,
                                      getFromJson(
                                        loanInformation?.employmentInfo,
                                        "employmentYears"
                                      )
                                    )
                                  }})</small
                                >
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employmentLevel'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-graduation icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Grade Level</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employmentLevel"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'employerPayDate'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-datepicker icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Paydate</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "employerPayDate"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'netIncome'
                              )
                            )
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-revenue-new icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Net Income</span
                              >
                              <h5 class="mb-0">
                                {{ ownerInformation?.currency?.currencySymbol }}
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "netIncome"
                                  ) | number : "1.2-2"
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'WorkPhone'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Work Phone</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "WorkPhone"
                                  )
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.employmentInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.employmentInfo,
                                'WorkEmail'
                              )
                            ) &&
                            getFromJson(
                              loanInformation?.employmentInfo,
                              'employmentStatus'
                            ) != 'SELF EMPLOYED'
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Work Email</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.employmentInfo,
                                    "WorkEmail"
                                  )
                                }}
                              </h5>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                    <div id="tab-loan-type-info" class="mb-5 border-bottom">
                      <div
                        class="h4 my-5"
                        [style.color]="currentTheme?.secondaryColor"
                      >
                        Loan Type Information
                      </div>
                      <ul class="dt-list dt-list-one-third">
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.loanTypeInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.loanTypeInfo,
                                'loanTypeName'
                              )
                            )
                          "
                        >
                          <div class="media">
                            <i
                              class="mr-3 icon icon-editor icon-3x align-self-center text-warning"
                            ></i>
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Loan Type</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.loanTypeInfo,
                                    "loanTypeName"
                                  )
                                }}
                              </h5>
                            </div>
                          </div>
                        </li>
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.loanTypeInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.loanTypeInfo,
                                'loanTypeCategory'
                              )
                            )
                          "
                        >
                          <div class="media">
                            <i
                              class="mr-3 icon icon-editor icon-3x align-self-center text-warning"
                            ></i>
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Loan Type Category</span
                              >
                              <h5 class="mb-0">
                                {{
                                  getFromJson(
                                    loanInformation?.loanTypeInfo,
                                    "loanTypeCategory"
                                  )
                                }}
                              </h5>
                            </div>
                          </div>
                        </li>
                        <li
                          class="dt-list__item"
                          *ngIf="
                            !isEmpty(loanInformation?.loanTypeInfo) &&
                            !isEmpty(
                              getFromJson(
                                loanInformation?.loanTypeInfo,
                                'loanInterestRate'
                              )
                            )
                          "
                        >
                          <div class="media">
                            <i
                              class="mr-3 icon icon-editor icon-3x align-self-center text-warning"
                            ></i>
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Loan Interest Rate</span
                              >
                              <h5 class="mb-0" style="position: relative">
                                <span *ngIf="!changeInterest">
                                  {{
                                    getFromJson(
                                      loanInformation?.loanTypeInfo,
                                      "loanInterestRate"
                                    )
                                  }}
                                </span>
                                <span style="position: relative">
                                  <input
                                    type="text"
                                    value="{{
                                      getFromJson(
                                        loanInformation?.loanTypeInfo,
                                        'loanInterestRate'
                                      )
                                    }}"
                                    *ngIf="changeInterest"
                                    style="
                                      width: 90px;
                                      border: 1px solid lightgrey;
                                    "
                                    (change)="
                                      updateInterestRate($event.target.value)
                                    "
                                    [disabled]="updateLoanInterestLoader"
                                  />

                                  <span
                                    [style.color]="currentTheme?.secondaryColor"
                                    *ngIf="updateLoanInterestLoader"
                                    class="icon icon-spin icon-spin2"
                                    style="
                                      position: absolute;
                                      right: 15px;
                                      top: 2px;
                                    "
                                  ></span>
                                </span>

                                <a
                                  href="javascript:;"
                                  *ngIf="
                                    currentuser?.permission?.includes(
                                      'Override Loan Product Interest Rate'
                                    ) && !updateLoanInterestLoader
                                  "
                                  (click)="changeInterest = !changeInterest"
                                >
                                  <i class="ml-2 icon icon-ripple icon-xl"></i>
                                </a>
                              </h5>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                    <div
                      id="bankstatement-tab"
                      *ngIf="bankStatementAvailable"
                      class="mb-5 border-bottom"
                    >
                      <div
                        class="h4 my-5"
                        [style.color]="currentTheme?.secondaryColor"
                      >
                        Bank Statement Information
                      </div>
                      <div
                        *ngIf="bankBalanceLoader"
                        class="table-loader"
                        style="text-align: center; color: indianred"
                      >
                        <span>
                          <i class="icon icon-spin icon-spin2"></i>
                          Loading...</span
                        >
                      </div>
                      <br />

                      <form
                        [formGroup]="bankStatementFilter"
                        *ngIf="bankStatementFilter"
                        (ngSubmit)="getBankStatement(bankStatementFilter.value)"
                      >
                        <div class="form-row form-group">
                          <div class="col-md-4">
                            <label>From <sup class="text-span"></sup></label>
                            <input
                              lndInvalidDateChecker
                              type="date"
                              class="form-control"
                              formControlName="StartDate"
                            />
                          </div>
                          <div class="col-md-4">
                            <label>To <sup class="text-span"></sup></label>
                            <input
                              lndInvalidDateChecker
                              type="date"
                              class="form-control"
                              formControlName="EndDate"
                            />
                          </div>
                          <div class="p-1 mt-5 col-md-4">
                            <button
                              type="submit"
                              class="btn btn-claim text-uppercase"
                            >
                              Load bank statement
                            </button>
                          </div>
                        </div>
                      </form>

                      <div
                        *ngIf="
                          !bankBalanceLoader &&
                          bankStatementLoaded &&
                          bankStatement?.balance === null
                        "
                        class="text-center"
                      >
                        <img
                          style="width: 25px"
                          src="assets/images/not-verified1.png"
                          alt="Default"
                        />&nbsp;
                        <span>
                          {{ loanInformation?.person?.displayName }} has not
                          linked balance</span
                        >
                      </div>

                      <div
                        *ngIf="
                          !bankBalanceLoader &&
                          bankStatementLoaded &&
                          bankStatement?.transactions === null
                        "
                        class="text-center"
                      >
                        <img
                          style="width: 25px"
                          src="assets/images/not-verified1.png"
                          alt="Default"
                        />&nbsp;
                        <span>
                          {{ loanInformation?.person?.displayName }} has not
                          linked transactions
                        </span>
                      </div>
                      <!-- List -->
                      <ul
                        class="dt-list"
                        *ngIf="
                          !!bankStatement?.integrationActive &&
                          bankStatement?.balance != null
                        "
                      >
                        <!-- List Item -->
                        <li class="dt-list__item">
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user icon-2x align-self-center text-warning"
                            ></i>
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Account Name</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.accountName }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                        </li>
                        <li class="dt-list__item">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>
                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Bank</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.bank }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                        </li>

                        <li class="dt-list__item">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-user icon-2x align-self-center text-warning"
                            ></i>
                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Customer Name</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.customerName }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                        </li>
                        <li class="dt-list__item">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-revenue-new icon-3x align-self-center text-warning"
                            ></i>
                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Available Balance</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.currency }}
                                {{
                                  bankStatement?.balance?.availableBalance
                                    | number : "1.2-2"
                                }}
                              </h5>
                            </div>
                          </div>
                        </li>
                        <!-- /media body -->

                        <li class="dt-list__item">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-revenue-new icon-3x align-self-center text-warning"
                            ></i>
                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Ledger Balance</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.currency }}
                                {{
                                  bankStatement?.balance?.ledgerBalance
                                    | number : "1.2-2"
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                        </li>

                        <li class="dt-list__item">
                          <div class="media">
                            <i
                              class="mr-3 icon icon-datepicker icon-2x align-self-center text-warning"
                            ></i>
                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Date Connected</span
                              >
                              <h5 class="mb-0">
                                {{ bankStatement?.balance?.dateConnected }}
                              </h5>
                            </div>
                          </div>
                        </li>
                      </ul>
                      <ul
                        class="dt-list"
                        *ngIf="bankStatement?.transactions != null"
                      >
                        <li class="dt-list__item">
                          <div class="media">
                            <div class="p-0 dt-card__body">
                              <div class="table-responsive">
                                <table
                                  class="table mb-0 table-striped"
                                  style="font-size: 11px"
                                >
                                  <thead class="">
                                    <tr>
                                      <th scope="col">Transaction Date</th>
                                      <th scope="col">Description</th>
                                      <th scope="col">Cleared Date</th>
                                      <th scope="col">Created Date</th>
                                      <th scope="col">Last Updated</th>
                                      <th
                                        class="text-uppercase amount-field"
                                        scope="col"
                                      >
                                        Credit
                                      </th>
                                      <th
                                        class="text-uppercase amount-field"
                                        scope="col"
                                      >
                                        Debit
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr
                                      *ngFor="
                                        let row of bankStatement?.transactions;
                                        let i = index
                                      "
                                    >
                                      <td class="amount-field">
                                        {{ row?.transDate }}
                                      </td>
                                      <td>
                                        {{ row?.description }}
                                      </td>
                                      <td class="amount-field">
                                        {{ row?.clearedDate }}
                                      </td>
                                      <td class="amount-field">
                                        {{ row?.createdAt }}
                                      </td>
                                      <td class="amount-field">
                                        {{ row?.lastUpdated }}
                                      </td>
                                      <td class="amount-field">
                                        {{ row?.credit | number : "1.2-2" }}
                                      </td>
                                      <td class="amount-field">
                                        {{ row?.debit | number : "1.2-2" }}
                                      </td>
                                    </tr>
                                  </tbody>
                                  <tfoot class="thead-light">
                                    <tr>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                      <th scope="col"></th>
                                      <th
                                        class="text-uppercase amount-field"
                                        scope="col"
                                      >
                                        {{ bankStatement?.balance?.currency }}
                                        {{
                                          bankStatement?.totalCredit
                                            | number : "1.2-2"
                                        }}
                                      </th>
                                      <th
                                        class="text-uppercase amount-field"
                                        scope="col"
                                      >
                                        {{ bankStatement?.balance?.currency }}
                                        {{
                                          bankStatement?.totalDebit
                                            | number : "1.2-2"
                                        }}
                                      </th>
                                    </tr>
                                  </tfoot>
                                </table>
                              </div>
                              <!-- /tables -->
                            </div>
                            <!-- /card body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->
                      </ul>
                      <!-- /list -->
                    </div>
                    <div
                      id="buyover-tab"
                      class="tab-pane"
                      *ngIf="!isEmpty(loanInformation?.lendingInstitutionId)"
                    >
                      <div
                        class="h4 my-5"
                        [style.color]="currentTheme?.secondaryColor"
                      >
                        Buy-Over Information
                      </div>
                      <ul class="dt-list dt-list-one-third">
                        <li class="dt-list__item">
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-revenue-new icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Buy-Over Amount</span
                              >
                              <h5 class="mb-0">
                                {{ ownerInformation?.currency?.currencySymbol }}
                                {{
                                  loanInformation?.buyOverAmount
                                    | number : "1.2-2"
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li class="dt-list__item">
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-company icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Lending Institution</span
                              >
                              <h5 class="mb-0">
                                {{
                                  loanInformation?.lendingInstitution
                                    ?.lendingInstitutionName
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->

                        <!-- List Item -->
                        <li class="dt-list__item">
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-phone icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Contact Phone Number</span
                              >
                              <h5 class="mb-0">
                                {{
                                  loanInformation?.lendingInstitution
                                    ?.phoneNumber
                                }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <li
                          class="dt-list__item"
                          *ngIf="
                            loanInformation?.lendingInstitutionId != null &&
                            loanInformation?.lendingInstitutionId != ''
                          "
                        >
                          <!-- Media -->
                          <div class="media">
                            <i
                              class="mr-3 icon icon-email icon-2x align-self-center text-warning"
                            ></i>

                            <!-- Media Body -->
                            <div class="media-body">
                              <span class="mb-1 d-block text-light-gray f-12"
                                >Email</span
                              >
                              <h5 class="mb-0">
                                {{ loanInformation?.lendingInstitution?.email }}
                              </h5>
                            </div>
                            <!-- /media body -->
                          </div>
                          <!-- /media -->
                        </li>
                        <!-- /list item -->
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div id="tab-pane2" class="tab-pane">
                <div
                  *ngIf="requestLoader"
                  class="table-loader"
                  style="text-align: center; color: indianred"
                >
                  <span>
                    <i class="icon icon-spin icon-spin2"></i> Loading...</span
                  >
                </div>

                <div class="row">
                  <div class="col-xl-10">
                    <div
                      class="h4 mt-5"
                      [style.color]="currentTheme?.secondaryColor"
                    >
                      Previous Loan Applications
                    </div>
                    <div class="overflow-hidden">
                      <div class="p-0 dt-card__body">
                        <div class="table-responsive">
                          <table
                            class="table mb-0"
                            style="font-size: 11px"
                            [ngClass]="
                              currentTheme?.theme === 'Dark'
                                ? ''
                                : 'table-striped'
                            "
                          >
                            <thead
                              [class]="
                                currentTheme?.theme === 'Dark'
                                  ? ''
                                  : 'thead-light'
                              "
                            >
                              <tr>
                                <th scope="col">Application Code</th>
                                <th scope="col">Loan Code</th>
                                <th class="amount-field" scope="col">
                                  Loan Amount
                                </th>

                                <th class="amount-field" scope="col">
                                  Amount To Be Repayed
                                </th>
                                <th class="amount-field" scope="col">
                                  Amount Repayed
                                </th>
                                <th class="amount-field" scope="col">
                                  Amount Outstanding
                                </th>
                                <th scope="col">Stage</th>
                                <th scope="col">View Info</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let row of loansummaryhistory;
                                  let i = index
                                "
                              >
                                <td
                                  [style.color]="currentTheme?.primaryColor"
                                  scope="row"
                                >
                                  {{ row?.applicationCode }}
                                </td>
                                <td scope="row">{{ row?.loanCode }}</td>
                                <td class="amount-field">
                                  {{ row?.loanAmount | number : "1.2-2" }}
                                </td>

                                <td class="amount-field">
                                  {{
                                    row?.totalAmountToBeRepayed
                                      | number : "1.2-2"
                                  }}
                                </td>
                                <td class="amount-field">
                                  {{ row?.amountRepayed | number : "1.2-2" }}
                                </td>
                                <td class="amount-field">
                                  {{
                                    row?.amountOutstanding | number : "1.2-2"
                                  }}
                                </td>
                                <td>{{ row?.loanStage }}</td>
                                <td>
                                  <a
                                    [style.color]="currentTheme?.secondaryColor"
                                    class="d-inline-block"
                                    href="javascript:void(0)"
                                    (click)="
                                      getLoanDetailsById(
                                        row?.loanId,
                                        loanViewerModal
                                      )
                                    "
                                    ><i
                                      class="mr-2 icon icon-forward icon-fw"
                                    ></i
                                    >View</a
                                  >
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="tab-pane3" class="tab-pane">
                <form
                  [formGroup]="AddCreditScoreForm"
                  (keydown.enter)="$event.preventDefault()"
                  (ngSubmit)="submitCreditScoreForm(AddCreditScoreForm.value)"
                >
                  <div class="row">
                    <div class="col-xl-8">
                      <div class="dt-card__full-height">
                        <div
                          class="h4 mt-5"
                          [style.color]="currentTheme?.secondaryColor"
                        >
                          Credit Score Partners
                        </div>
                        <div class="dt-card__body p-0">
                          <div class="row no-gutters">
                            <div class="col-sm-6">
                              <ul class="dt-indicator">
                                <li class="dt-indicator-item">
                                  <h5 class="dt-indicator-title f-12">
                                    First Central
                                    <small
                                      *ngIf="
                                        loanInformation?.creditScoreChecked ==
                                          true &&
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          'Source'
                                        ) == 'First Central'
                                      "
                                      class="pl-2 ml-1 d-inline-block border-left text-light-gray"
                                      >last Checked:
                                      {{
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          "DateCreated"
                                        )
                                      }}
                                      by
                                      {{
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          "CheckedBy"
                                        )
                                      }}</small
                                    >
                                  </h5>

                                  <div
                                    *ngIf="
                                      loanInformation?.statusString == 'Claimed'
                                    "
                                    class="dt-indicator-item__info"
                                    data-fill="78"
                                    data-max="100"
                                    data-percent="true"
                                  >
                                    <div
                                      class="dt-indicator-item__fill bg-success"
                                    ></div>

                                    <button
                                      class="mt-1 mb-3 btn btn-query btn-xs"
                                      type="button"
                                      (click)="
                                        submitQueryRequest(
                                          1,
                                          1,
                                          loanInformation,
                                          queryProcessModal,
                                          'This will initiate an external search'
                                        )
                                      "
                                    >
                                      Find Customer
                                    </button>
                                  </div>
                                </li>
                              </ul>
                            </div>

                            <div class="col-sm-6">
                              <ul class="dt-indicator">
                                <li class="dt-indicator-item">
                                  <h5 class="dt-indicator-title f-12">
                                    Credit Registry
                                    <small
                                      *ngIf="
                                        loanInformation?.creditScoreChecked ==
                                          true &&
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          'Source'
                                        ) == 'Credit Registry'
                                      "
                                      class="pl-2 ml-1 d-inline-block border-left text-light-gray"
                                      >last Checked:
                                      {{
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          "DateCreated"
                                        )
                                      }}
                                      by
                                      {{
                                        getFromJson(
                                          loanInformation?.creditScoreCheckInfo,
                                          "CheckedBy"
                                        )
                                      }}</small
                                    >
                                  </h5>

                                  <div
                                    *ngIf="
                                      loanInformation?.statusString == 'Claimed'
                                    "
                                    class="dt-indicator-item__info"
                                    data-fill="52"
                                    data-max="100"
                                    data-percent="true"
                                  >
                                    <div
                                      class="dt-indicator-item__fill bg-danger"
                                    ></div>
                                    <button
                                      class="mt-1 mb-3 btn btn-query btn-xs"
                                      type="button"
                                      (click)="
                                        submitQueryRequest(
                                          2,
                                          1,
                                          loanInformation,
                                          queryProcessModal,
                                          'This will initiate an external search'
                                        )
                                      "
                                    >
                                      Find Customer
                                    </button>
                                  </div>
                                </li>
                              </ul>
                            </div>
                          </div>
                          <div class="row no-gutters">
                            <br />
                            <table
                              class="table mb-0 table-striped"
                              *ngIf="
                                loanInformation?.loanType?.creditScoringRule !=
                                ''
                              "
                            >
                              <thead class="thead-light">
                                <tr>
                                  <th scope="col">Partner</th>
                                  <th class="" scope="col">Queried By</th>
                                  <th class="" scope="col">Document</th>
                                </tr>
                              </thead>
                              <tbody></tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div id="tab-pane4" class="tab-pane">
                <div class="dt-card__body p-0">
                  <ng-container *ngIf="!isMultiLevelApproval">
                    <div class="mb-2 dropdown d-inline-block"></div>
                    <div class="row">
                      <div class="col-xl-6 col-md-6">
                        <label class="input-group-text">
                          <span *ngIf="!isRedraftReason">Internal Note</span>
                          <span *ngIf="isRedraftReason">Redraft Reason</span>
                          <span
                            *ngIf="
                              loanInformation?.approversInfo != null &&
                              loanInformation?.approversInfo != ''
                            "
                            >&nbsp;by:
                            {{
                              getFromJson(
                                getFromJson(
                                  loanInformation?.approversInfo,
                                  "loanappplication"
                                ),
                                "CommentBy"
                              )
                            }}. Date:
                            {{
                              getFromJson(
                                getFromJson(
                                  loanInformation?.approversInfo,
                                  "loanappplication"
                                ),
                                "DateCreated"
                              )
                            }}
                          </span></label
                        >

                        <textarea
                          *ngIf="
                            loanInformation?.statusString == 'Claimed' &&
                            !isRedraftReason
                          "
                          class="form-control"
                          formControlName="InternalNote"
                          rows="7"
                          cols="150"
                          aria-label="With textarea"
                        ></textarea>

                        <textarea
                          *ngIf="isRedraftReason"
                          class="form-control"
                          [(ngModel)]="reasonString"
                          [ngModelOptions]="{ standalone: true }"
                          placeholder="Write reason here and/or select any below"
                          rows="7"
                          cols="150"
                          aria-label="With textarea"
                        ></textarea>

                        <div
                          *ngIf="
                            loanInformation?.statusString != 'Claimed' &&
                            loanInformation?.approversInfo != null &&
                            loanInformation?.approversInfo != ''
                          "
                        >
                          <textarea
                            class="form-control"
                            [readonly]="
                              loanInformation?.statusString != 'Claimed'
                            "
                            value=" {{
                              getFromJson(
                                getFromJson(
                                  loanInformation?.approversInfo,
                                  'loanappplication'
                                ),
                                'InternalNote'
                              )
                            }}"
                            rows="7"
                            cols="180"
                            aria-label="With textarea"
                          ></textarea>
                        </div>
                      </div>

                      <div
                        class="col-xl-6 col-md-6"
                        *ngIf="loanInformation?.statusString == 'Claimed'"
                      >
                        <span
                          class="text-center"
                          *ngIf="
                            getFromJson(
                              loanInformation?.repaymentInfo,
                              'repaymentMethod'
                            ) == 'Deduction At Source'
                          "
                          >*Repayment method for applicant is:
                          <span style="color: red">{{
                            getFromJson(
                              loanInformation?.repaymentInfo,
                              "repaymentMethod"
                            )
                          }}</span
                          >, kindly ensure repayment agreement with applicant's
                          Employers is Uploaded</span
                        >
                        <br /><br />
                        <div class="form-group mb-3">
                          <label class="">Supporting Documents</label>
                          <div
                            class="custom-file input-group"
                            data-provides="fileinput"
                          >
                            <span
                              class="input-group-addon btn btn-default btn-file"
                              [style.color]="currentTheme?.secondaryColor"
                            >
                              <input
                                type="file"
                                id="files"
                                multiple
                                (change)="handleFileInput($event.target.files)"
                              />
                            </span>
                            <!-- <a href="javascript:void(0)" class="input-group-addon btn btn-default fileinput-exists" data-dismiss="fileinput" (click)="clearFileHandler()">Remove</a> -->
                          </div>
                        </div>
                        <div
                          class="row"
                          *ngIf="
                            currentuser?.permission?.includes(
                              'Set Loan Application Start Date'
                            )
                          "
                        >
                          <div class="col-md-6">
                            <div class="form-group">
                              <label class="left-aligned"
                                >Loan Start Date</label
                              >
                              <div
                                class="input-group date"
                                id="date-time-picker-2"
                                data-target-input="nearest"
                              >
                                <input
                                  lndInvalidDateChecker
                                  type="date"
                                  [(ngModel)]="loanStartDate"
                                  [ngModelOptions]="{ standalone: true }"
                                  class="form-control"
                                  (change)="
                                    onLoanDateChange($event.target.value)
                                  "
                                  formControlName="LoanStartDate"
                                  [min]="today"
                                />
                              </div>
                              <small
                                *ngIf="
                                  loanDateError &&
                                  loanStartDate !== null &&
                                  !loanStartDate
                                "
                                style="text-align: center; color: indianred"
                                >Invalid date</small
                              >
                            </div>
                          </div>
                        </div>
                      </div>
                      <div
                        class="col-xl-6 col-md-6"
                        *ngIf="
                          loanInformation?.statusString != 'Claimed' &&
                          loanInformation?.preferredFirstRepaymentDate != null
                        "
                      >
                        <label class="input-group-text"
                          >Preferred First Repayment Date (d/m/y):
                          {{
                            loanInformation?.preferredFirstRepaymentDate
                              | date : "dd/MM/yyyy"
                          }}
                        </label>
                      </div>
                    </div>

                    <br *ngIf="isRedraftReason" />
                    <div class="col-md-8 pl-0" *ngIf="isRedraftReason">
                      <div class="row mt-4 d-flex align-items-center">
                        <div class="col-md-3">
                          <label class="input-group-text"
                            ><small>Select Redraft Reasons</small></label
                          >
                        </div>
                        <div class="col-md-7">
                          <slct-2
                            [multiple]="true"
                            [data]="allReasonsSelectData"
                            (selected)="selectedReason($event)"
                            (removed)="removedReason($event)"
                            placeholder="Select Reason(s)"
                          ></slct-2>
                        </div>
                        <div class="com-md-2">
                          <a
                            href="javascript:void(0)"
                            (click)="cancelRedraft()"
                            color="blue"
                          >
                            Cancel Redraft
                          </a>
                        </div>
                      </div>
                    </div>

                    <br />
                    <br />
                    <div>
                      <div
                        class="row"
                        *ngIf="loanInformation?.statusString == 'Claimed'"
                      >
                        <div class="col-md-4">
                          <label class="input-group-text"
                            ><small
                              >First Repayment Date (D/M/Y) :
                              <span
                                *ngIf="
                                  (loanInformation?.preferredFirstRepaymentDate ==
                                    null ||
                                    loanInformation?.preferredFirstRepaymentDate ==
                                      '') &&
                                  !(
                                    loanInformation?.loanStartDate ||
                                    loanStartDate
                                  )
                                "
                                >Date Disbursed</span
                              >
                              <span
                                *ngIf="
                                  loanInformation?.preferredFirstRepaymentDate !=
                                    null &&
                                  loanInformation?.preferredFirstRepaymentDate !=
                                    '' &&
                                  !(
                                    loanInformation?.loanStartDate ||
                                    loanStartDate
                                  )
                                "
                              >
                                <b>{{
                                  loanInformation?.preferredFirstRepaymentDate
                                    | date : "dd/MM/yyyy"
                                }}</b></span
                              >

                              <span
                                *ngIf="
                                  loanInformation?.loanStartDate ||
                                  loanStartDate
                                "
                                >Loan start date</span
                              >
                            </small>
                          </label>
                          <small
                            *ngIf="
                              !(loanInformation?.loanStartDate || loanStartDate)
                            "
                            ><a
                              [style.color]="currentTheme?.secondaryColor"
                              href="javascript:void(0)"
                              (click)="toggleView('FRDate')"
                              color="blue"
                            >
                              Click here to change <b>repayment start date</b>
                            </a>
                          </small>
                        </div>

                        <div class="col-md-3" *ngIf="NewRepaymentDateSection">
                          <input
                            lndInvalidDateChecker
                            type="date"
                            (change)="setDate($event.target.value)"
                            class="form-control"
                          />
                          <small
                            ><a
                              *ngIf="
                                !repaymentLoader &&
                                !isEmpty(NewFirstRepaymentDate)
                              "
                              href="javascript:void(0)"
                              (click)="viewRepaymentSchedule(repaymentSchedule)"
                              color="blue"
                            >
                              Click here to view <b>repayment schedule</b>
                            </a>
                            <i
                              *ngIf="repaymentLoader"
                              class="icon icon-spin icon-spin2"
                            >
                            </i>
                          </small>
                        </div>
                        <div class="col-md-2"></div>

                        <!-- Form Group -->
                        <div class="col-md-2">
                          <label class="input-group-text"
                            ><small>Enter Transaction Pin</small></label
                          >
                        </div>
                        <div class="col-md-2">
                          <input
                            type="password"
                            [readonly]="
                              loanInformation?.statusString != 'Claimed'
                            "
                            class="form-control"
                            formControlName="TransactionPin"
                            placeholder="************"
                            autocomplete="off"
                          />
                        </div>

                        <div class="col-md-8" *ngIf="isBlacklist">
                          <div class="row mt-4 d-flex align-items-center">
                            <div class="col-md-3">
                              <label class="input-group-text"
                                ><small>Provide Blacklist Reason</small></label
                              >
                            </div>
                            <div class="col-md-7">
                              <textarea
                                class="form-control"
                                cols="3"
                                rows="3"
                                [(ngModel)]="blackListReason"
                                [ngModelOptions]="{ standalone: true }"
                              ></textarea>
                            </div>
                            <div class="com-md-2">
                              <a
                                href="javascript:void(0)"
                                (click)="cancelBlacklist()"
                                color="blue"
                              >
                                Cancel Blacklist
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- /form group -->
                      </div>

                      <div
                        class="row"
                        *ngIf="
                          loanInformation?.statusString == 'Claimed' &&
                          currentuser?.permission?.includes(
                            'Review Claimed Applications'
                          )
                        "
                      >
                        <div class="text-center form-group">
                          <button
                            type="submit"
                            *ngIf="!loader && !isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="statusCheck('Rejected')"
                            class="btn btn-danger text-uppercase error-alert"
                          >
                            Deny Application
                          </button>
                          &nbsp;

                          <button
                            *ngIf="
                              !loader &&
                              !isBlacklist &&
                              currentuser?.permission?.includes(
                                'Request Customer Blacklist'
                              ) &&
                              !isRedraftReason
                            "
                            [disabled]="AddResponseForm.invalid"
                            (click)="blacklistCustomer($event)"
                            class="btn btn-dark text-uppercase error-alert"
                          >
                            Blacklist Customer
                          </button>

                          <a
                            href="javascript:void(0)"
                            *ngIf="!loader && !isRedraftReason && isBlacklist"
                            (click)="cancelBlacklist()"
                            class="btn text-uppercase success-toast"
                          >
                            Cancel Blacklist
                          </a>
                          &nbsp;

                          <button
                            *ngIf="!loader && isBlacklist && !isRedraftReason"
                            (click)="blacklistCustomer($event, 'withReason')"
                            class="btn btn-dark text-uppercase error-alert"
                          >
                            Confirm Blacklist
                          </button>
                          &nbsp;

                          <button
                            *ngIf="
                              !loader &&
                              !isRedraftReason &&
                              !isBlacklist &&
                              loanInformation?.recordEntryMedium !==
                                'QuickLoanProduct'
                            "
                            [disabled]="AddResponseForm.invalid"
                            (click)="cancelRedraft($event)"
                            class="btn btn-warning text-uppercase success-toast"
                          >
                            Redraft Application
                          </button>

                          <a
                            href="javascript:void(0)"
                            *ngIf="!loader && isRedraftReason && !isBlacklist"
                            (click)="cancelRedraft()"
                            class="btn text-uppercase success-toast"
                          >
                            Cancel Redraft
                          </a>
                          &nbsp;
                          <button
                            *ngIf="!loader && isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="confirmRedraft($event)"
                            class="btn btn-warning text-uppercase success-toast"
                          >
                            Confirm Redraft
                          </button>
                          &nbsp;
                          <button
                            type="submit"
                            *ngIf="!loader && !isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="statusCheck('Approved')"
                            class="btn btn-success text-uppercase success-alert"
                          >
                            Approve Application
                          </button>
                          <button
                            type="button"
                            class="btn btn-claim btn-sm"
                            *ngIf="loader"
                            [disabled]="true"
                          >
                            <i class="icon icon-spin icon-spin2"></i>
                            Processing...
                          </button>
                        </div>
                      </div>
                    </div>
                    <ng-template #pendingBlacklist>
                      <div>
                        <p class="text-center h3 text-danger">
                          <span
                            *ngIf="
                              loanInformation?.person?.personStatus === 2;
                              else blacklisted
                            "
                            >No further action can be taken on this loan as
                            customer blacklist request is under review.</span
                          >
                          <ng-template #blacklisted
                            >No further action can be taken on this as
                            loancustomer has been blacklisted</ng-template
                          >
                        </p>
                      </div>
                    </ng-template>

                    <br />
                  </ng-container>
                  <ng-container *ngIf="isMultiLevelApproval">
                    <lnd-approval-comment
                      *ngFor="let review of loanWithApprovalWorkflow?.reviews"
                      [review]="review"
                    />
                    <no-data
                      *ngIf="
                        isMultiLevelApproval &&
                        !loanWithApprovalWorkflow?.reviews?.length
                      "
                      title="No reviews yet"
                    ></no-data>
                    <form
                      *ngIf="loanInformation?.statusString == 'Claimed'"
                      [formGroup]="AddResponseForm"
                      class="mt-5"
                    >
                      <div class="row">
                        <div class="col-md-6">
                          <div class="form-group">
                            <label for="comment">Approval Comment</label>
                            <textarea
                              class="form-control"
                              formControlName="InternalNote"
                              rows="3"
                              placeholder="Enter comment"
                            ></textarea>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-4">
                          <label for="txPin">Enter Transaction Pin</label>
                          <input
                            id="txPin"
                            type="password"
                            formControlName="TransactionPin"
                            class="form-control"
                            placeholder="Transaction pin"
                            (keydown.enter)="$event.preventDefault()"
                          />
                        </div>
                      </div>
                      <br *ngIf="isRedraftReason" />
                      <div class="col-md-8 pl-0" *ngIf="isRedraftReason">
                        <div class="row mt-4 d-flex align-items-center">
                          <div class="col-md-3">
                            <label class="input-group-text"
                              ><small>Select Redraft Reasons</small></label
                            >
                          </div>
                          <div class="col-md-7">
                            <slct-2
                              [multiple]="true"
                              [data]="allReasonsSelectData"
                              (selected)="selectedReason($event)"
                              (removed)="removedReason($event)"
                              placeholder="Select Reason(s)"
                            ></slct-2>
                          </div>
                          <div class="com-md-2">
                            <a
                              href="javascript:void(0)"
                              (click)="cancelRedraft()"
                              color="blue"
                            >
                              Cancel Redraft
                            </a>
                          </div>
                        </div>
                      </div>
                      <div
                        class="row"
                        *ngIf="
                          loanInformation?.statusString == 'Claimed'
                        "
                      >
                        <div class="col-md-12 mt-5">
                          <button
                            type="button"
                            *ngIf="!loader && !isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="onReviewMultiLevelApprovalLoan('Rejected')"
                            class="btn btn-danger text-uppercase error-alert mr-2"
                          >
                            Deny Application
                          </button>
                          <button
                            type="button"
                            *ngIf="
                              !loader &&
                              !isBlacklist &&
                              currentuser?.permission?.includes(
                                'Request Customer Blacklist'
                              ) &&
                              !isRedraftReason &&
                              loanInformation?.recordEntryMedium !== 'Wacs'
                            "
                            [disabled]="AddResponseForm.invalid"
                            (click)="blacklistCustomer($event)"
                            class="btn black-list-btn text-uppercase mr-2"
                          >
                            Blacklist Customer
                          </button>
                          <a
                            href="javascript:void(0)"
                            *ngIf="!loader && !isRedraftReason && isBlacklist"
                            (click)="cancelBlacklist()"
                            class="btn text-uppercase success-toast"
                          >
                            Cancel Blacklist
                          </a>
                          <button
                            type="button"
                            *ngIf="!loader && isBlacklist && !isRedraftReason"
                            (click)="blacklistCustomer($event, 'withReason')"
                            class="btn btn-dark text-uppercase error-alert"
                          >
                            Confirm Blacklist
                          </button>
                          <button
                            *ngIf="
                              !loader &&
                              !isRedraftReason &&
                              !isBlacklist &&
                              loanInformation?.recordEntryMedium !==
                                'QuickLoanProduct' &&
                              loanInformation?.recordEntryMedium !== 'Wacs'
                            "
                            [disabled]="AddResponseForm.invalid"
                            (click)="cancelRedraft($event)"
                            class="btn btn-warning text-uppercase success-toast mr-2"
                          >
                            Redraft Application
                          </button>
                          <a
                            href="javascript:void(0)"
                            *ngIf="!loader && isRedraftReason && !isBlacklist"
                            (click)="cancelRedraft()"
                            class="btn text-uppercase success-toast"
                          >
                            Cancel Redraft
                          </a>
                          <button
                            type="button"
                            *ngIf="!loader && isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="confirmRedraft($event)"
                            class="btn btn-warning text-uppercase success-toast"
                          >
                            Confirm Redraft
                          </button>
                          <button
                            type="button"
                            *ngIf="!loader && !isRedraftReason && !isBlacklist"
                            [disabled]="AddResponseForm.invalid"
                            (click)="onReviewMultiLevelApprovalLoan('Approved')"
                            class="btn btn-success text-uppercase success-alert"
                          >
                            Approve Application
                          </button>
                          <button
                            type="button"
                            class="btn btn-claim btn-sm"
                            *ngIf="loader"
                            [disabled]="true"
                          >
                            <i class="icon icon-spin icon-spin2"></i>
                            Processing...
                          </button>
                        </div>
                      </div>
                    </form>
                    <div class="dt-card__body p-0">
                      <br />
                      <br />
                      <div>
                        <div
                          class="row"
                          *ngIf="loanInformation?.statusString == 'Claimed'"
                        >
                          <div class="col-md-3" *ngIf="NewRepaymentDateSection">
                            <input
                              lndInvalidDateChecker
                              type="date"
                              (change)="setDate($event.target.value)"
                              class="form-control"
                            />
                            <small
                              ><a
                                *ngIf="
                                  !repaymentLoader &&
                                  !isEmpty(NewFirstRepaymentDate)
                                "
                                href="javascript:void(0)"
                                (click)="
                                  viewRepaymentSchedule(repaymentSchedule)
                                "
                                color="blue"
                              >
                                Click here to view <b>repayment schedule</b>
                              </a>
                              <i
                                *ngIf="repaymentLoader"
                                class="icon icon-spin icon-spin2"
                              >
                              </i>
                            </small>
                          </div>
                          <div class="col-md-8" *ngIf="isBlacklist">
                            <div class="row mt-4 d-flex align-items-center">
                              <div class="col-md-3">
                                <label class="input-group-text"
                                  ><small
                                    >Provide Blacklist Reason</small
                                  ></label
                                >
                              </div>
                              <div class="col-md-7">
                                <textarea
                                  class="form-control"
                                  cols="3"
                                  rows="3"
                                  [(ngModel)]="blackListReason"
                                  [ngModelOptions]="{ standalone: true }"
                                ></textarea>
                              </div>
                              <div class="com-md-2">
                                <a
                                  href="javascript:void(0)"
                                  (click)="cancelBlacklist()"
                                  color="blue"
                                >
                                  Cancel Blacklist
                                </a>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <ng-template #pendingBlacklist>
                        <div>
                          <p class="text-center h3 text-danger">
                            <span
                              *ngIf="
                                loanInformation?.person?.personStatus === 2;
                                else blacklisted
                              "
                              >No further action can be taken on this loan as
                              customer blacklist request is under review.</span
                            >
                            <ng-template #blacklisted
                              >No further action can be taken on this as
                              loancustomer has been blacklisted</ng-template
                            >
                          </p>
                        </div>
                      </ng-template>

                      <br />
                    </div>
                  </ng-container>
                </div>
              </div>
              <div id="tab-bankStatementAnalysis" class="tab-pane">
                <div *ngIf="showBankStatementAnalysis && loanInformation">
                  <bank-statement-analysis
                    [currentTheme]="currentTheme"
                    [ownerInformation]="ownerInformation"
                    [loanInformation]="loanInformation"
                  ></bank-statement-analysis>
                </div>
              </div>
              <div id="tab-pane6" class="tab-pane mb-5">
                <div class="row">
                  <div class="col-sm-12">
                    <button
                      *ngIf="
                        !isEmpty(
                          getFromJson(
                            loanInformation?.employmentInfo,
                            'bankStatement'
                          )
                        )
                      "
                      class="mb-2 mr-2 btn btn-outline-primary"
                      type="button"
                      (click)="
                        documentViewer(
                          '',
                          getFromJson(
                            loanInformation?.employmentInfo,
                            'bankStatement'
                          ),
                          getFromJson(
                            loanInformation?.employmentInfo,
                            'fileUploadType'
                          ),
                          documentViewerModal
                        )
                      "
                      aria-expanded="false"
                      aria-controls="doc1"
                    >
                      <i class="mr-3 icon icon-folder-o icon-xl"></i>View Bank
                      Statement
                    </button>
                    <button
                      *ngIf="
                        !isEmpty(loanInformation?.residentialInfo) &&
                        !isEmpty(
                          getFromJson(
                            loanInformation?.residentialInfo,
                            'utilityBill'
                          )
                        )
                      "
                      class="mb-2 mr-2 btn btn-outline-primary"
                      (click)="
                        documentViewer(
                          '',
                          getFromJson(
                            loanInformation?.residentialInfo,
                            'utilityBill'
                          ),
                          getFromJson(
                            loanInformation?.residentialInfo,
                            'fileUploadType'
                          ),
                          documentViewerModal
                        )
                      "
                      type="button"
                      data-toggle="collapse"
                      data-target="#doc1"
                      aria-expanded="false"
                      aria-controls="doc1"
                    >
                      <i class="mr-3 icon icon-folder-o icon-xl"></i>View
                      Utility Bill
                    </button>
                    <div class="overflow-hidden">
                      <div class="d-flex justify-content-between my-5">
                        <h4 class="m-0">Documents</h4>
                        <button
                          [disabled]="uploadingFiles"
                          type="button"
                          class="doc-upload-btn px-3 py-2"
                          (click)="docsUpload.click()"
                        >
                          <i
                            *ngIf="!uploadingFiles"
                            class="icon icon-upload mr-2"
                          ></i>
                          <span *ngIf="!uploadingFiles" class="mb-1"
                            >Upload Document</span
                          >
                          <i
                            *ngIf="uploadingFiles"
                            class="icon icon-spin icon-spin2 mr-2"
                          ></i>
                          <span *ngIf="uploadingFiles" class="mb-1"
                            >Upload Document</span
                          >
                        </button>
                      </div>
                      <div class="p-0 dt-card__body">
                        <div
                          class="table-responsive"
                          *ngIf="!isEmpty(loanInformation?.files)"
                        >
                          <table
                            class="table mb-0"
                            style="font-size: 11px"
                            [ngClass]="
                              currentTheme?.theme === 'Dark'
                                ? ''
                                : 'table-striped'
                            "
                          >
                            <thead>
                              <tr>
                                <th
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                  scope="col"
                                >
                                  File Name
                                </th>
                                <th
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                  scope="col"
                                >
                                  Stage
                                </th>
                                <th
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                  scope="col"
                                >
                                  Date Uploaded (M/d/y)
                                </th>
                                <th
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                  scope="col"
                                >
                                  Action
                                </th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let row of loanInformation?.files;
                                  let i = index
                                "
                              >
                                <td
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                  scope="row"
                                >
                                  {{ row?.originalName }}
                                </td>
                                <td
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                >
                                  {{ row?.activity }}
                                </td>
                                <td
                                  [style.color]="
                                    currentTheme?.theme === 'Dark'
                                      ? currentTheme?.dark?.textColor
                                      : ''
                                  "
                                >
                                  {{ row?.createdAt }}
                                </td>
                                <td>
                                  <a
                                    class="d-inline-block"
                                    (click)="
                                      documentViewer(
                                        row?.fileName,
                                        row?.filePath,
                                        row?.fileType,
                                        documentViewerModal
                                      )
                                    "
                                    href="javascript:void(0)"
                                    ><i
                                      class="mr-2 icon icon-forward icon-fw"
                                    ></i
                                    >View</a
                                  >
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                        <div
                          class="text-center"
                          *ngIf="isEmpty(loanInformation?.files)"
                        >
                          <no-data
                            title="No file(s) uploaded for this application"
                          ></no-data>
                        </div>
                        <input
                          #docsUpload
                          class="docs-upload-input"
                          type="file"
                          id="files"
                          multiple
                          (change)="handleFileInput($event.target.files)"
                        />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="tab-pane7" class="tab-pane">
                <div class="row">
                  <div class="col-xl-8">
                    <div class="pb-4">
                      <div class="dt-card__header mb-3 pt-0 pl-0">
                        <div
                          class="h4 mt-5"
                          [style.color]="currentTheme?.secondaryColor"
                        >
                          Events & Comments
                        </div>
                        <div class="dt-card__tools">
                          <a
                            href="javascript:void(0)"
                            (click)="
                              submitLoanRequest(
                                'LoanActivities',
                                loanInformation?.loanId,
                                loanInformation?.applicationCode
                              )
                            "
                            class="dt-card__more"
                            [style.color]="currentTheme?.secondaryColor"
                            >Refresh Activities
                            <i class="icon icon-ripple icon-xl ml-2"></i
                          ></a>
                        </div>
                      </div>
                      <div class="p-0 dt-card__body">
                        <div
                          *ngIf="this.requestLoader"
                          class="table-loader"
                          style="text-align: center; color: indianred"
                        >
                          <span>
                            <i class="icon icon-spin icon-spin2"></i>
                            Loading...</span
                          >
                        </div>

                        <!-- Tables -->
                        <div class="table-responsive">
                          <table
                            class="table mb-0"
                            style="font-size: 11px"
                            [ngClass]="
                              currentTheme?.theme === 'Dark'
                                ? ''
                                : 'table-striped'
                            "
                          >
                            <thead
                              [class]="
                                currentTheme?.theme === 'Dark'
                                  ? ''
                                  : 'thead-light'
                              "
                            >
                              <tr>
                                <th class="text-center" scope="col">
                                  Activity
                                </th>
                                <th class="text-center" scope="col">
                                  Description
                                </th>
                                <th class="text-center" scope="col">Date</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr
                                *ngFor="
                                  let row of loanactivities;
                                  let i = index
                                "
                              >
                                <td
                                  class="text-center code"
                                  [style.color]="currentTheme?.secondaryColor"
                                >
                                  {{ row?.relatedObjectInitiatorCode }}
                                </td>
                                <td>{{ row?.activityDescription }}</td>
                                <td>
                                  {{ row?.activityDate | date : "medium" }}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div
                    class="col-xl-4 col-md-6 col-12 order-xl-1"
                    *ngIf="!isEmpty(loanInformation?.approversInfo)"
                  >
                    <div class="">
                      <div class="dt-card__body p-0">
                        <div
                          class="mb-5 media"
                          *ngIf="
                            loanInformation?.approversInfo != null &&
                            loanInformation?.approversInfo != ''
                          "
                        >
                          <i
                            [style.color]="currentTheme?.secondaryColor"
                            class="mr-3 icon icon-user icon-xl orange"
                          ></i>
                          <div class="media-body">
                            <span class="mb-1 d-block text-light-gray f-12"
                              >Review Officer</span
                            >
                            <span class="h5"
                              >{{
                                getFromJson(
                                  getFromJson(
                                    loanInformation?.approversInfo,
                                    "loanappplication"
                                  ),
                                  "CommentBy"
                                )
                              }}. </span
                            ><br />
                            <span
                              >Comment:{{
                                getFromJson(
                                  getFromJson(
                                    loanInformation?.approversInfo,
                                    "loanappplication"
                                  ),
                                  "InternalNote"
                                )
                              }} </span
                            ><br />
                            <small
                              >Date:
                              {{
                                getFromJson(
                                  getFromJson(
                                    loanInformation?.approversInfo,
                                    "loanappplication"
                                  ),
                                  "DateCreated"
                                )
                              }}</small
                            >
                            <br />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</aside>

<ng-template #queryProcessModal>
  <!-- Modal -->
  <!-- Modal Body -->
  <div class="modal-body" style="background-color: beige">
    <div
      *ngIf="this.requestLoader"
      class="table-loader"
      style="text-align: center; color: indianred"
    >
      <span> <i class="icon icon-spin icon-spin2"></i> Loading...</span>
    </div>

    <!-- Login Content Inner -->
    <div class="dt-login__content-inner">
      <span> {{ feedbackdata }} </span>

      <!-- Tables -->
      <div *ngIf="currentSource == 'First Central'" class="table-responsive">
        <table
          *ngIf="possibleResults?.length > 0"
          class="table mb-0 table-striped"
        >
          <thead>
            <tr>
              <th>Firstname</th>
              <th>Surname</th>
              <th>Othernames</th>
              <th>Address</th>
              <th>Birthdate</th>
              <th>Account No</th>
              <th>Action</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let row of possibleResults; let i = index">
              <td class="code small">{{ row?.FirstName }}</td>
              <td class="code small">{{ row?.Surname }}</td>
              <td>{{ row?.OtherNames }}</td>
              <td>{{ row?.Address }}</td>
              <td>{{ row?.BirthDate }}</td>
              <td>{{ row?.AccountNo }}</td>
              <td></td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- /tables -->

      <!-- /form group -->

      <!-- /form -->
    </div>
    <!-- /login content inner -->
  </div>
  <!-- /modal body -->

  <!-- /modal -->
</ng-template>

<ng-template #loanViewerModal>
  <!-- Modal -->
  <!-- Modal Body -->
  <div class="modal-body" id="printSelectedLoanInformationwithHeader">
    <div class="border-0 modal-header">
      <div class="row">
        <div class="col-md-12">
          <div class="mt-3 ml-3">
            <img
              *ngIf="ownerInformation?.logoUrl"
              class="mb-3 dt-brand__logo-img"
              width="120px"
              [src]="ownerInformation?.logoUrl"
              alt="Logo"
            />
            <img
              *ngIf="!ownerInformation?.logoUrl"
              class="mb-3 dt-brand__logo-img"
              width="120px"
              src="assets/images/logo-blue.png"
              alt="Logo"
            />
            <h3 class="mb-2 dt-card__title">
              {{ ownerInformation?.appOwnerName | uppercase }}
            </h3>
            <span
              class="mb-2 dt-card__title text-light-gray ft-12"
              *ngIf="!isEmpty(ownerInformation?.appOwnerBillingAddress)"
            >
              <i class="mr-2 icon icon-company"></i
              >{{ ownerInformation?.appOwnerBillingAddress }} </span
            ><br />
            <span
              class="mb-2 dt-card__title text-light-gray ft-12"
              *ngIf="!isEmpty(ownerInformation?.appOwnerEmail)"
            >
              <i class="mr-2 icon icon-email"></i
              >{{ ownerInformation?.appOwnerEmail }}</span
            ><br />
            <span
              class="mb-2 dt-card__title text-light-gray ft-12"
              *ngIf="!isEmpty(ownerInformation?.appOwnerPhone)"
            >
              <i class="mr-2 icon icon-phone"></i
              >{{ ownerInformation?.appOwnerPhone }}</span
            ><br />
          </div>
        </div>
        <div class="text-right col-md-4 pull-right"></div>
      </div>
    </div>

    <div class="m-2 modal-body" id="printSelectedLoanInformation">
      <h4 class="mt-2 text-center mb-7 f-18">
        <span class="align-middle black text-uppercase"> Loan Details</span>
      </h4>
      <div class="row">
        <div class="col-md-6">
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="!isEmpty(loanhistoryperson?.displayName)"
            ><span class="black">Name: </span>
            {{ loanhistoryperson?.displayName }}</span
          ><br />
          <span
            class="mb-1 text-light-gray f-12"
            *ngIf="!isEmpty(loanhistoryperson?.emailAddress)"
            ><span class="black">Email: </span
            >{{ loanhistoryperson?.emailAddress }}</span
          ><br />
          <span
            class="mb-1 text-light-gray f-12"
            *ngIf="
              !isEmpty(
                getFromJson(loanhistoryinformation?.bvnInfo, 'bvnPhoneNumber')
              )
            "
            ><span class="black">Phone: </span
            >{{
              getFromJson(loanhistoryinformation?.bvnInfo, "bvnPhoneNumber")
            }}</span
          ><br />
          <span
            class="mb-1 text-light-gray f-12"
            *ngIf="
              !isEmpty(
                getFromJson(loanhistoryinformation?.residentialInfo, 'address')
              )
            "
            ><span class="black">Address: </span
            >{{
              getFromJson(loanhistoryinformation?.residentialInfo, "address")
            }}</span
          ><br />
        </div>

        <div class="col-md-6" style="text-align: right">
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="!isEmpty(loanhistoryinformation?.loanAmount)"
            ><span class="black">Loan Amount: </span>
            {{ ownerInformation?.currency?.currencySymbol
            }}{{ loanhistoryinformation?.loanAmount | number : "1.2-2" }}</span
          ><br />
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="!isEmpty(loanhistoryinformation?.loanTenor)"
            ><span class="black">Duration: </span
            >{{ loanhistoryinformation?.loanTenor }}
            {{ loanhistoryinformation?.repaymentScheduleType
            }}{{ loanhistoryinformation?.loanTenor === 1 ? "" : "s" }}</span
          ><br />
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="
              !isEmpty(
                getFromJson(
                  loanhistoryinformation?.repaymentInfo,
                  'repaymentMethod'
                )
              )
            "
            ><span [style.color]="currentTheme?.secondaryColor" class="black"
              >Repayment Method: </span
            >{{
              getFromJson(
                loanhistoryinformation?.repaymentInfo,
                "repaymentMethod"
              )
            }}</span
          ><br />
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="!isEmpty(loanhistoryinformation?.loanType?.loanName)"
            ><span class="black">Loan Type: </span
            >{{ loanhistoryinformation?.loanType?.loanName }}</span
          ><br />
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            *ngIf="!isEmpty(loanhistoryinformation?.applicationCode)"
            ><span class="black">Code: </span>
            {{ loanhistoryinformation?.applicationCode }}</span
          ><br />
          <span
            [style.color]="currentTheme?.secondaryColor"
            class="mb-1 orange f-12"
            ><span class="black"> Stage: </span
            >{{ loanhistoryinformation?.loanStage
            }}<span
              *ngIf="
                loanhistoryinformation?.loanCode != null &&
                loanhistoryinformation?.loanCode != ''
              "
            >
              - {{ loanhistoryinformation?.loanCode }}
            </span></span
          >
        </div>
      </div>
      <br />
      <h5
        [style.color]="currentTheme?.secondaryColor"
        class="mt-2 text-center orange"
      >
        Customer's Information
      </h5>
      <div class="row">
        <div class="col-md-6">
          <div class="dt-card dt-card__full-height">
            <span class="mt-3 text-center black">Personal Information</span>
            <ul class="ml--20 f-12 td-0">
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(loanhistoryinformation?.bvnInfo, 'bvnNumber')
                  )
                "
              >
                <span class="black">BVN: </span
                >{{ getFromJson(loanhistoryinformation?.bvnInfo, "bvnNumber") }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(loanhistoryinformation?.bvnInfo, 'bvnDOB')
                  )
                "
              >
                <span class="black">DOB: </span
                >{{
                  getFromJson(loanhistoryinformation?.bvnInfo, "bvnDOB")
                    | date : "mediumDate"
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.bvnInfo,
                      'bvnPhoneNumber'
                    )
                  )
                "
              >
                <span class="black">BVN Phone: </span
                >{{
                  getFromJson(loanhistoryinformation?.bvnInfo, "bvnPhoneNumber")
                }}
              </li>
              <li class="mb-2" *ngIf="!isEmpty(loanhistoryperson?.sex)">
                <span class="black">Gender: </span>{{ loanhistoryperson?.sex }}
              </li>

              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(loanhistoryinformation?.bankInfo, 'bankName')
                  )
                "
              >
                <span class="black">Bank: </span
                >{{ getFromJson(loanhistoryinformation?.bankInfo, "bankName") }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.bankInfo,
                      'bankAccountNumber'
                    )
                  )
                "
              >
                <span class="black">Account Number: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.bankInfo,
                    "bankAccountNumber"
                  )
                }}
              </li>
              <!-- <li class="mb-2"><span class="black">Address: </span>{{ getFromJson(loanhistoryinformation?.residentialInfo,'address') }}</li>   -->
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.residentialInfo,
                      'nextOfKinName'
                    )
                  )
                "
              >
                <span class="black">Next of Kin Name: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.residentialInfo,
                    "nextOfKinName"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.residentialInfo,
                      'nextOfKinPhoneNumber'
                    )
                  )
                "
              >
                <span class="black">Next of Kin Phone Number: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.residentialInfo,
                    "nextOfKinPhoneNumber"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.residentialInfo,
                      'nextOfKinAddress'
                    )
                  )
                "
              >
                <span class="black">Next of Kin Address: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.residentialInfo,
                    "nextOfKinAddress"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.loanTypeInfo,
                      'loanReasonCode'
                    )
                  ) &&
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.loanTypeInfo,
                      'loanReasonName'
                    )
                  )
                "
              >
                <span class="black">Loan Reason: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.loanTypeInfo,
                    "loanReasonCode"
                  )
                }}:
                {{
                  getFromJson(
                    loanhistoryinformation?.loanTypeInfo,
                    "loanReasonName"
                  )
                }}
              </li>
            </ul>
          </div>
        </div>
        <div class="col-md-6">
          <div class="dt-card dt-card__full-height">
            <span class="mt-3 text-center black">Employment Information</span>
            <ul class="ml--20 f-12 td-0">
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'netIncome'
                    )
                  )
                "
              >
                <span class="black">Net Income: </span
                >{{ ownerInformation?.currency?.currencySymbol }}
                {{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "netIncome"
                  ) | number : "1.2-2"
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employmentStatus'
                    )
                  )
                "
              >
                <span class="black">Employment Status: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employmentStatus"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employmentIndustry'
                    )
                  )
                "
              >
                <span class="black">Industry: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employmentIndustry"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employerName'
                    )
                  )
                "
              >
                <span class="black">Works At: </span>
                {{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employerName"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFullDateDiff(
                      loanhistoryinformation?.createdAt,
                      getFromJson(
                        loanhistoryinformation?.employmentInfo,
                        'employmentYears'
                      )
                    )
                  )
                "
              >
                <span class="black">Years Of Employment: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employmentYears"
                  )
                }}
                ({{
                  getFullDateDiff(
                    loanhistoryinformation?.createdAt,
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      "employmentYears"
                    )
                  )
                }})
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employmentLevel'
                    )
                  )
                "
              >
                <span class="black">Grade Level: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employmentLevel"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employerPayDate'
                    )
                  )
                "
              >
                <span class="black">Paydate: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employerPayDate"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'employerAddress'
                    )
                  )
                "
              >
                <span class="black">Address:</span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "employerAddress"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'WorkPhone'
                    )
                  )
                "
              >
                <span class="black">Work Phone: </span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "WorkPhone"
                  )
                }}
              </li>
              <li
                class="mb-2"
                *ngIf="
                  !isEmpty(
                    getFromJson(
                      loanhistoryinformation?.employmentInfo,
                      'WorkEmail'
                    )
                  )
                "
              >
                <span class="black">Work Email:</span
                >{{
                  getFromJson(
                    loanhistoryinformation?.employmentInfo,
                    "WorkEmail"
                  )
                }}
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-md-12">
        <div class="dt-card dt-card__full-height">
          <div class="row">
            <div
              class="text-center col-sm-4"
              *ngIf="
                loanhistoryinformation?.approversInfo != null &&
                loanhistoryinformation?.approversInfo != ''
              "
            >
              <h6
                [style.color]="currentTheme?.secondaryColor"
                class="mt-3 orange"
              >
                Review Information
              </h6>
              <ul class="ml--20 f-12 td-0">
                <li
                  *ngIf="
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.approversInfo,
                        'loanappplication'
                      ),
                      'InternalNote'
                    ) != null &&
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.approversInfo,
                        'loanappplication'
                      ),
                      'InternalNote'
                    ) != ''
                  "
                  class="mb-2"
                >
                  <span class="black">Internal Note: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.approversInfo,
                        "loanappplication"
                      ),
                      "InternalNote"
                    )
                  }}
                </li>
                <li
                  class="mb-2"
                  *ngIf="
                    !isEmpty(
                      getFromJson(
                        getFromJson(
                          loanhistoryinformation?.approversInfo,
                          'loanappplication'
                        ),
                        'DateCreated'
                      )
                    )
                  "
                >
                  <span class="black">Date Reviewed: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.approversInfo,
                        "loanappplication"
                      ),
                      "DateCreated"
                    )
                  }}
                </li>
                <li
                  class="mb-2"
                  *ngIf="
                    !isEmpty(
                      getFromJson(
                        getFromJson(
                          loanhistoryinformation?.approversInfo,
                          'loanappplication'
                        ),
                        'CommentBy'
                      )
                    )
                  "
                >
                  <span class="black">Reviewed By: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.approversInfo,
                        "loanappplication"
                      ),
                      "CommentBy"
                    )
                  }}
                </li>
              </ul>
            </div>
            <div
              class="text-center col-sm-4"
              *ngIf="
                loanInformation?.statusString != 'Claimed' &&
                loanhistoryinformation?.verificationInfo != null &&
                loanhistoryinformation?.verificationInfo != ''
              "
            >
              <h6 class="mt-3 orange">Repayment Verification Information</h6>
              <ul class="ml--20 f-12 td-0">
                <li class="mb-2">
                  <span class="black">Internal Note: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.verificationInfo,
                        "loanverification"
                      ),
                      "InternalNote"
                    )
                  }}
                </li>
                <li class="mb-2">
                  <span class="black">Date Verified: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.verificationInfo,
                        "loanverification"
                      ),
                      "DateCreated"
                    )
                  }}
                </li>
                <li class="mb-2">
                  <span class="black">Verified By: </span
                  >{{
                    getFromJson(
                      getFromJson(
                        loanhistoryinformation?.verificationInfo,
                        "loanverification"
                      ),
                      "CommentBy"
                    )
                  }}
                </li>
              </ul>
            </div>

            <div
              class="text-center col-sm-4"
              *ngIf="loanInformation?.loanDisbursementId != null"
            >
              <h6 class="mt-3 orange">Disbursement Information</h6>
              <ul class="ml--20 f-12 td-0">
                <li
                  class="mb-2"
                  *ngIf="!isEmpty(loanhistoryinformation?.dateDisbursed)"
                >
                  <span class="black">Date Disbursed: </span
                  >{{
                    loanhistoryinformation?.dateDisbursed | date : "mediumDate"
                  }}
                </li>
                <li
                  class="mb-2"
                  *ngIf="
                    !isEmpty(
                      loanhistoryinformation?.disbursementClaimer?.person
                        ?.displayName
                    )
                  "
                >
                  <span class="black">Disbursed By: </span
                  >{{
                    loanhistoryinformation?.disbursementClaimer?.person
                      ?.displayName
                  }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <div class="row" *ngIf="loanhistoryinformation?.repaymentSchedule">
        <div
          class="col-md-4"
          *ngIf="loanhistoryinformation?.repaymentSchedule.length > 0"
        >
          <h5 class="mt-3 text-center orange">Repayment Schedule</h5>
          <!-- Tables -->
          <div class="table bd-1">
            <table
              class="table table-bordered table-hover"
              style="font-size: 12px"
            >
              <thead class="thead-light">
                <tr>
                  <th class="text-center">Date Expected</th>
                  <th class="text-right amount-field" scope="col">
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                </tr>
              </thead>
              <tbody>
                <!-- <tbody> {{ loanhistoryinformation?.repaymentSchedule }} -->
                <tr
                  *ngFor="
                    let row of loanhistoryinformation?.repaymentSchedule;
                    let i = index
                  "
                >
                  <td class="text-center">
                    {{ row?.paymentDueDate | date : "mediumDate" }}
                  </td>
                  <td class="text-right amount-field">
                    {{ row?.paymentAmount | number : "1.2-2" }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- /tables -->
        </div>

        <div
          class="col-md-8"
          *ngIf="loanhistoryinformation?.payment.length > 0"
        >
          <h5 class="mt-3 text-center orange">Payments</h5>
          <!-- Tables -->
          <div class="table-responsive">
            <table
              class="table table-bordered table-hover"
              style="font-size: 11px"
            >
              <thead class="thead-light">
                <tr>
                  <th class="text-center" scope="col">Payment Code</th>
                  <th class="text-center" scope="col">Date</th>
                  <th class="text-center" scope="col">Type</th>
                  <th class="text-center" scope="col">Mode</th>
                  <th class="text-right" scope="col">
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                  <th class="text-center" scope="col">Status</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="
                    let row of loanhistoryinformation?.payment;
                    let i = index
                  "
                >
                  <td class="text-center code">{{ row?.paymentCode }}</td>
                  <td class="text-center">
                    {{ row?.paymentDate | date : "mediumDate" }}
                  </td>
                  <td class="text-center">
                    {{ row?.paymentTypeString | titlecase }}
                  </td>
                  <td class="text-center">
                    {{ row?.paymentModeString | titlecase }}
                  </td>
                  <td class="amount-field">
                    {{ row?.paymentAmount | number : "1.2-2" }}
                  </td>
                  <td class="text-center">
                    <span
                      *ngIf="row?.status == 'Reconciled'"
                      style="color: #6faa8f"
                      >{{ row?.status }}
                    </span>
                    <span
                      *ngIf="row?.status != 'Reconciled'"
                      style="color: rebeccapurple"
                      >{{ row?.status }}
                    </span>
                  </td>
                </tr>
              </tbody>
              <tfoot>
                <td colspan="4" class="amount-field small">
                  Total Repayment Made:
                </td>
                <td class="amount-field small">
                  <b>{{
                    getTotalSection(
                      "repayments",
                      loanhistoryinformation?.payment,
                      ""
                    ) | number : "1.2-2"
                  }}</b>
                </td>
                <td></td>
              </tfoot>
            </table>
          </div>
          <!-- /tables -->
        </div>
      </div>
    </div>
  </div>
  <!-- /modal body -->

  <!-- Modal Footer -->
  <div class="modal-footer">
    <button
      type="button"
      class="text-white btn btn-warning btn-xs"
      (click)="closeModal()"
    >
      Dismiss
    </button>

    <button
      type="button"
      class="text-white btn btn-claim btn-xs"
      (click)="
        printThisDocument('printSelectedLoanInformation', 'to_be_printed')
      "
    >
      Print without header
    </button>
    <button
      [style.backgroundColor]="currentTheme?.secondaryColor"
      [style.borderColor]="currentTheme?.secondaryColor"
      type="button"
      class="text-white btn orange-bg btn-xs"
      (click)="
        printThisDocument(
          'printSelectedLoanInformationwithHeader',
          'to_be_printed'
        )
      "
    >
      Print with header
    </button>
  </div>
  <!-- /modal footer -->
</ng-template>

<ng-template #documentViewerModal>
  <!-- Modal -->

  <!-- Modal Header -->
  <div class="modal-header">
    <h3 class="modal-title" id="model-4">Document Viewer</h3>
    <button
      type="button"
      class="close"
      (click)="closeModal()"
      aria-label="Close"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>

  <!-- Modal Body -->
  <div class="modal-body">
    <div class="mb-5 row">
      <div class="col-xl-12">
        <div
          *ngIf="currentFileType == 'image'"
          id="imagefile"
          style="text-align: center"
        >
          <img class="" width="90%;" src="{{ currentFileUrl }}" alt="Default" />
        </div>

        <!-- Card -->
        <div
          *ngIf="currentFileType == 'document'"
          id="docfile"
          style="text-align: center"
        >
          <span
            ><i class="mr-2 icon icon-exclamation" style="color: indianred"></i
            >If document is taking too long to load, please click on the
            download button below</span
          ><br /><br />
          <!-- <iframe [src]="currentFileUrl" frameborder="0" height="500px" width="100%"></iframe> -->
          <!-- <pdf-viewer [src]="currentFileUrl"
       [render-text]="true"
       style="display: block;"></pdf-viewer> -->
          <!-- <ngx-extended-pdf-viewer [src]="currentFileUrl" useBrowserLocale="true" height="80vh"></ngx-extended-pdf-viewer> -->
        </div>
        <!-- car-->
      </div>
    </div>
  </div>
  <!-- /modal body -->

  <!-- Modal Footer -->
  <div class="modal-footer">
    <button
      [style.backgroundColor]="currentTheme?.secondaryColor"
      [style.borderColor]="currentTheme?.secondaryColor"
      type="button"
      class="text-white btn orange-bg btn-xs"
      (click)="closeModal()"
    >
      <i class="mr-2 icon icon-long-arrow-left icon-fw"></i>Back to review
    </button>
    <a
      href="javascript:void(0);"
      target="_blank"
      class="text-white btn btn-claim btn-xs"
      (click)="downloadfile()"
    >
      <i class="mr-2 icon icon-long-arrow-down icon-fw"></i>Download</a
    >
  </div>
  <!-- /modal footer -->
</ng-template>

<ng-template #recallModal let-modal>
  <!-- Modal Header -->

  <!-- /modal header -->
  <!-- Form -->
  <form [formGroup]="RecallLoanForm" (ngSubmit)="recallSingleLoan()">
    <!-- Modal Body -->
    <div class="modal-body">
      <!-- Login Content Inner -->
      <div class="dt-login__content-inner">
        <div class="mb-8 text-center">
          <!-- Avatar -->
          <!-- /avatar -->

          <div class="row">
            <span
              class="mr-4 text-white dt-avatar size-35 rounded-circle bg-light-blue"
              >{{ currentuser?.person?.initials }}</span
            >

            <h3 class="mb-2">{{ currentuser?.person?.displayName }}</h3>
            <h6></h6>
          </div>

          <!-- Form Group -->
          <div class="form-group">
            <label class="sr-only" for="password-1">Confirm Password</label>
            Enter your Transaction Pin to Recall this Loan
            <input
              type="password"
              class="form-control"
              formControlName="transactionPin"
              placeholder="Transaction Pin"
              autocomplete="off"
            />
          </div>
          <!-- /form group -->

          <!-- /form -->
        </div>
        <!-- /login content inner -->
      </div>
    </div>
    <!-- /modal body -->

    <!-- Modal Footer -->
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-secondary btn-sm"
        (click)="modal.close()"
        style="color: #fff"
      >
        Close
      </button>
      <button
        type="submit"
        class="btn btn-claim btn-sm"
        *ngIf="!loader"
        [disabled]="RecallLoanForm.invalid"
      >
        Recall Loan
      </button>
      <button
        type="button"
        class="btn btn-claim btn-sm"
        *ngIf="loader"
        [disabled]="true"
      >
        <i class="icon icon-spin icon-spin2"></i> Processing...
      </button>
    </div>
    <!-- /modal footer -->
  </form>
  <!-- /form -->
</ng-template>
<ng-template #multiRecallModal let-modal>
  <!-- Modal Header -->

  <!-- /modal header -->
  <!-- Form -->
  <form [formGroup]="RecallMultiLoanForm" (ngSubmit)="recallSelectedLoans()">
    <!-- Modal Body -->
    <div class="modal-body">
      <!-- Login Content Inner -->
      <div class="dt-login__content-inner">
        <div class="mb-8 text-center">
          <!-- Avatar -->
          <!-- /avatar -->

          <div class="row">
            <span
              class="mr-4 text-white dt-avatar size-35 rounded-circle bg-light-blue"
              >{{ currentuser?.person?.initials }}</span
            >

            <h3 class="mb-2">{{ currentuser?.person?.displayName }}</h3>
            <h6></h6>

            <table class="table table-striped">
              <thead>
                <tr>
                  <th>Applicant</th>
                  <th>Application Code</th>
                  <th class="amount-field">
                    <i
                      class="icon icon-revenue-new align-self-center text-warning"
                    ></i>
                    Amount ({{ ownerInformation?.currency?.currencySymbol }})
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr
                  class="gradeX"
                  *ngFor="let row of loansToRecall; let i = index"
                >
                  <td class="small">
                    <span>{{ row?.customerName }}</span>
                  </td>
                  <td class="code small">{{ row?.applicationCode }}</td>
                  <td class="amount-field small">
                    {{ row?.loanAmount | number : "1.2-2" }}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Form Group -->
          <div class="form-group">
            <label class="sr-only" for="password-1">Confirm Password</label>
            Enter your Transaction Pin to Recall {{ loansToRecall.length }} Loan
            <span *ngIf="loansToRecall.length > 1">s</span> selected.
            <input
              type="password"
              class="form-control"
              formControlName="transactionPin"
              placeholder="Transaction Pin"
              autocomplete="off"
            />
          </div>
          <!-- /form group -->

          <!-- /form -->
        </div>
        <!-- /login content inner -->
      </div>
    </div>
    <!-- /modal body -->

    <!-- Modal Footer -->
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-secondary btn-sm"
        (click)="modal.close()"
        style="color: #fff"
      >
        Close
      </button>
      <button
        type="submit"
        class="btn btn-claim btn-sm"
        *ngIf="!loader"
        [disabled]="RecallMultiLoanForm.invalid"
      >
        Recall Loans
      </button>
      <button
        type="button"
        class="btn btn-claim btn-sm"
        *ngIf="loader"
        [disabled]="true"
      >
        <i class="icon icon-spin icon-spin2"></i> Processing...
      </button>
    </div>
    <!-- /modal footer -->
  </form>
  <!-- /form -->
</ng-template>

<ng-template #redraftReasonModal let-modal>
  <div class="modal-header">
    <div class="modal-title">Select redraft reasons</div>
    <button
      type="button"
      class="close"
      (click)="modal.dismiss()"
      aria-label="Close"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="mb-3 row">
      <div class="col-md-12">
        <slct-2
          [multiple]="true"
          [data]="allReasonsSelectData"
          (selected)="selectedReason($event)"
          (removed)="removedReason($event)"
          placeholder="Select Reason(s)"
        ></slct-2>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #repaymentSchedule>
  <!-- Modal Content -->
  <div class="modal-content">
    <!-- Modal Header -->
    <div class="border-0 modal-header">
      <h3
        [style.color]="currentTheme?.secondaryColor"
        class="modal-title orange"
        id="model-1"
      >
        Repayment Schedule
      </h3>
      <button
        type="button"
        class="close"
        data-dismiss="modal"
        aria-label="Close"
        (click)="closeModal()"
      >
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <!-- /modal header -->

    <!-- Modal Body -->
    <div class="modal-body">
      <div class="row mt-1 mb-6">
        <div class="col-md-12 mt-3">
          <div class="shadow-sm p-5 bg-gainsboro rounded">
            <div class="d-flex justify-content-between align-items-center my-3">
              <p>Loan amount:</p>
              <p>
                {{ ownerInformation?.currency?.currencySymbol
                }}{{ loanInformation?.loanAmount | number : "1.2-2" }}
              </p>
            </div>
            <div class="d-flex justify-content-between align-items-center my-3">
              <p>
                Fees upfront
                <span
                  ><i
                    class="icon icon-question-circle icon-fw icon-xl"
                    placement="top"
                    ngbTooltip="Deducted before disbursement"
                  ></i></span
                >:
              </p>
              <p>
                {{
                  this.scheduleInformation.feesInfo.totalUpFrontFees
                    | number : "1.2-2"
                }}
              </p>
            </div>
            <div class="d-flex justify-content-between align-items-center my-3">
              <p>
                Fees capitalized<span
                  ><i
                    class="icon icon-question-circle icon-fw icon-xl"
                    ngbTooltip="Spread accross the lifespan of the schedule"
                  ></i></span
                >:
              </p>
              <p>
                {{
                  this.scheduleInformation.feesInfo.totalPostDisbursementFees
                    | number : "1.2-2"
                }}
              </p>
            </div>

            <div class="d-flex justify-content-between align-items-center my-3">
              <p>Total fees:</p>
              <p>
                {{
                  this.scheduleInformation.feesInfo.totalPostDisbursementFees +
                    this.scheduleInformation.feesInfo.totalUpFrontFees
                    | number : "1.2-2"
                }}
              </p>
            </div>
            <div class="d-flex justify-content-between align-items-center my-3">
              <p><b>Amount to be disbursed to customer:</b></p>
              <p>
                <b>
                  {{
                    this.scheduleInformation.feesInfo.amountToBeDisbursed
                      | number : "1.2-2"
                  }}</b
                >
              </p>
            </div>
            <div class="d-flex justify-content-between align-items-center my-3">
              <p>Amount used to generate schedule:</p>
              <p>
                {{
                  this.scheduleInformation.feesInfo.amountUsedForSchedule
                    | number : "1.2-2"
                }}
              </p>
            </div>
          </div>
        </div>
      </div>
      <!-- Tables -->
      <div class="table-responsive">
        <table class="table mb-0 table-striped">
          <thead class="thead-light">
            <tr>
              <th scope="col">Period</th>
              <th class="text-center" scope="col">Date</th>
              <th class="text-right" scope="col">Installment</th>
            </tr>
          </thead>
          <tbody *ngIf="repaymentScheduleArray.length > 0">
            <tr *ngFor="let item of repaymentScheduleArray; let i = index">
              <td scope="row">{{ item?.paymentNumber }}</td>
              <td class="text-center">
                {{ item?.paymentDueDate | date : "mediumDate" }}
              </td>
              <td class="text-right">
                {{ item?.paymentAmount | number : "1.2-2" }}
              </td>
            </tr>
          </tbody>
          <tbody *ngIf="repaymentLoader">
            <tr>
              <td colspan="3" style="text-align: center">Loading ...</td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- tables -->
    </div>
    <!-- modal body -->

    <!-- Modal Footer -->
    <div class="border-0 modal-footer">
      <button
        [style.backgroundColor]="currentTheme?.secondaryColor"
        [style.borderColor]="currentTheme?.secondaryColor"
        type="button"
        class="btn btn-secondary btn-sm white"
        (click)="closeModal()"
      >
        Close
      </button>
      <!-- <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal">Save changes</button> -->
    </div>
    <!-- /modal footer -->
  </div>
  <!-- /modal content -->
</ng-template>

<ng-template #reAssignReviewerModal let-modal>
  <!-- Modal Header -->

  <!-- /modal header -->
  <!-- Form -->
  <form [formGroup]="reassignReviewerForm" (ngSubmit)="reAssignUserToLoans()">
    <!-- Modal Body -->
    <div class="modal-body">
      <!-- Login Content Inner -->
      <div class="dt-login__content-inner">
        <div class="mb-8">
          <!-- Avatar -->
          <!-- /avatar -->

          <div class="d-flex align-items-center mb-3">
            <span
              class="mr-4 text-white dt-avatar size-35 rounded-circle bg-light-blue"
              >{{ currentuser?.person?.initials }}</span
            >

            <h3 class="mb-2">{{ currentuser?.person?.displayName }}</h3>
          </div>

          <table class="table table-striped">
            <thead>
              <tr>
                <th>Code</th>
                <th>Applicant</th>
                <th>Reviewer</th>
                <th class="amount-field">
                  ({{ ownerInformation?.currency?.currencySymbol }}) Amount
                </th>
              </tr>
            </thead>
            <tbody>
              <tr
                class="gradeX"
                *ngFor="
                  let row of claimedApplicationSelection.selected;
                  let i = index
                "
              >
                <td class="code small">{{ row?.applicationCode }}</td>
                <td class="small">
                  <span>{{ row?.applicantName }}</span>
                </td>
                <td class="small">
                  <span>{{ row?.reviewerName }}</span>
                </td>
                <td class="amount-field small">
                  {{ row?.loanAmount | number : "1.2-2" }}
                </td>
              </tr>
            </tbody>
          </table>
          <div
            class="mt-8"
            *ngIf="
              claimedApplicationSelection.selected[0].isMultiLevelLoanApproval
            "
          >
            <p class="reviewers-list-info-text">
              The list of reviewers have been filtered to show only those with
              roles assigned to review multi-approval loan applications
            </p>
          </div>
          <div class="form-group mt-5">
            <label>Select New Reviewer/Underwriter</label>
            <slct-2
              [data]="resPersonOpts"
              [customSearchEnabled]="true"
              (selected)="selected('Users', $event)"
              (removed)="removed('Users', $event)"
              placeholder="Select User"
            ></slct-2>
          </div>
          <!-- Form Group -->
          <div class="form-group">
            <label>Transaction pin</label>
            <input
              type="password"
              class="form-control"
              formControlName="transactionPin"
              placeholder="Transaction Pin"
              autocomplete="off"
            />
          </div>
          <!-- /form group -->

          <!-- /form -->
        </div>
        <!-- /login content inner -->
      </div>
    </div>
    <!-- /modal body -->

    <!-- Modal Footer -->
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-secondary btn-sm"
        (click)="modal.close()"
        style="color: #fff"
      >
        Close
      </button>
      <button
        type="submit"
        class="btn btn-claim btn-sm"
        *ngIf="!loader"
        [disabled]="reassignReviewerForm.invalid"
      >
        Assign to New Reviewer
      </button>
      <button
        type="button"
        class="btn btn-claim btn-sm"
        *ngIf="loader"
        [disabled]="true"
      >
        <i class="icon icon-spin icon-spin2"></i> Processing...
      </button>
    </div>
    <!-- /modal footer -->
  </form>
  <!-- /form -->
</ng-template>
<ng-template #editLoanAppInfoView>
  <lnd-edit-loan-application-info
    [loanId]="selectedLoanWithHistoryId"
    [loanType]="selectedLoanWithHistoryLoanType"
    (edited)="onLoanEdited()"
  />
</ng-template>
<ng-template #loanReassignmentErrorView>
  <lnd-loan-reassignment-error />
</ng-template>

<lnd-filter-menu
  [showPopup]="showPopup"
  [filterTypes]="[FILTER_TYPES.Branch, FILTER_TYPES.LoanProduct]"
  [isLoading]="requestLoader"
  (closePopup)="showPopup = false"
/>
