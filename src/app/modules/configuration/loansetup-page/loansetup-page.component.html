<!-- Profile Banner -->
<div
  class="profile__banner"
  [style.background]="
    currentTheme?.theme === 'dark'
      ? currentTheme?.dark?.primaryColor
      : currentTheme?.primaryColor
  "
>
  <!-- Profile Banner Top -->
  <div class="profile__banner-top">
    <!-- Avatar Wrapper -->
    <div class="dt-avatar-wrapper">
      <!-- Info -->
      <div class="dt-avatar-info">
        <span class="mb-2 dt-avatar-name display-4 font-weight-light"
          >Loan Setup</span
        >
        <span class="f-16"
          >This is where you change the settings of your loan details.</span
        >
      </div>
      <!-- /info -->
    </div>
    <!-- /avatar wrapper -->
  </div>
  <!-- /profile banner top -->

  <!-- Profile Banner Bottom -->
  <div class="profile__banner-bottom">
    <!-- Navbar -->
    <ul class="card-header-pills nav nav-pills" role="tablist">
      <!-- Nav Item -->
      <li class="nav-item active">
        <a
          class="nav-link active show"
          data-toggle="tab"
          href="#tab-pane-9"
          role="tab"
          aria-controls="tab-pane-9"
          aria-selected="true"
          >Customer Access</a
        >
      </li>
      <li
        class="nav-item"
        *ngIf="user?.permission?.includes('Manage Business Information')"
      >
        <a
          class="nav-link"
          data-toggle="tab"
          href="#tab-pane-6"
          role="tab"
          aria-controls="tab-pane-6"
          aria-selected="true"
          >Loan Setup
        </a>
      </li>
      <!-- /nav item -->

      <li
        *ngIf="
          user?.permission?.includes('Manage Business Information') &&
          user?.permission?.includes('Setup Multi LoanTypes')
        "
        class="nav-item"
      >
        <a
          class="nav-link"
          data-toggle="tab"
          href="#multi-loan"
          role="tab"
          aria-controls="tab-pane-11"
          aria-selected="true"
          (click)="getMultiLoanConfigs()"
          >Multi Loan Configuration</a
        >
      </li>

      <li
        class="nav-item active"
        *ngIf="user?.permission?.includes('Manage Business Information')"
      >
        <a
          class="nav-link"
          data-toggle="tab"
          href="#tab-pane-7"
          role="tab"
          aria-controls="tab-pane-7"
          aria-selected="true"
          >Disbursement Setup
        </a>
      </li>

      <li
        class="nav-item active"
        *ngIf="
          user?.permission?.includes('Manage Business Information') &&
          enableFeature() &&
          (user.permission?.includes('View Loan Disbursement Group') ||
            user.permission?.includes('View Loan Disbursement Limit') ||
            user.permission?.includes(
              'View Loan Disbursement Limit Notification'
            ))
        "
      >
        <a
          class="nav-link"
          data-toggle="tab"
          href="#disb-limit"
          role="tab"
          aria-controls="tab-pane-7"
          aria-selected="true"
          >Disbursement Limit
        </a>
      </li>

      <!-- Nav Item -->
      <li
        class="nav-item"
        (click)="ussdServices()"
        *ngIf="user?.permission?.includes('Manage USSD')"
      >
        <a
          class="nav-link"
          data-toggle="tab"
          href="#tab-pane-10"
          role="tab"
          aria-controls="tab-pane-10"
          aria-selected="true"
          >Ussd Setup</a
        >
      </li>
      <!-- Nav Item -->
      <li class="nav-item">
        <a
          class="nav-link"
          data-toggle="tab"
          href="#tab-pane-11"
          role="tab"
          aria-controls="tab-pane-11"
          aria-selected="true"
          >Loan Bulk upload</a
        >
      </li>
      <li class="nav-item">
        <a
          class="nav-link"
          data-toggle="tab"
          href="#notifications"
          role="tab"
          aria-controls="tab-pane-11"
          aria-selected="true"
          >Notifications</a
        >
      </li>
    </ul>
    <!-- /navbar -->
  </div>
  <!-- /profile banner bottom -->
</div>
<!-- /profile banner -->

<!-- tab content -->
<div class="tab-content">
  <!-- Tab panel -->

  <div id="tab-pane-5" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-4 d-none order-xl-2">
        <!-- Grid -->
        <div class="row">
          <!-- Grid Item -->
          <div class="col-xl-12 col-md-6 col-12 order-xl-1">
            <!-- Card -->
            <div class="dt-card dt-card__full-height">
              <!-- Card Header -->
              <div class="dt-card__header">
                <!-- Card Heading -->
                <div class="dt-card__heading">
                  <h3 class="dt-card__title">Support</h3>
                </div>
                <!-- /card heading -->
              </div>
              <!-- /card header -->

              <!-- Card Body -->
              <div class="dt-card__body">
                <!-- Media -->
                <div class="mb-5 media">
                  <i class="mr-5 icon icon-email icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12">Mail</span>
                    <a href="javascript:void(0)">dvlprs@lenda.com</a>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->

                <!-- Media -->
                <div class="mb-5 media">
                  <i class="mr-5 icon icon-link icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12"
                      >Web Page</span
                    >
                    <a href="javascript:void(0)">lenda.com</a>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->

                <!-- Media -->
                <div class="media">
                  <i class="mr-5 icon icon-phone icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12">Phone</span>
                    <span class="h5 orange">+234 01 8390923</span>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->
              </div>
              <!-- /card body -->
            </div>
            <!-- /card -->
          </div>
          <!-- /grid item -->
        </div>
        <!-- /grid -->
      </div>
      <!-- /grid item -->

      <!-- Grid Item -->
      <div class="col-xl-8 offset-xl-2 order-xl-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Force Events Here</h2>
            <span
              *ngIf="requestLoader"
              class="table-loader"
              style="text-align: center; color: indianred"
            >
              <i class="icon icon-spin icon-spin2"></i> Loading...</span
            >
          </div>
          <!-- /card header -->

          <!-- Card Body -->
          <div class="dt-card__body">
            <!-- Section -->
            <section id="theme-chooser">
              <h6 class="text-uppercase">Events</h6>

              <!-- Button Group -->
              <div class="mb-1 dt-customizer__btn-group">
                <div class="col-md-12 col-md-offset-4">
                  <div class="mb-2 checkbox switcher">
                    <label for="test">
                      <i class="mr-5 icon icon-setting icon-spin icon-xs"></i>
                      <a
                        href="javascript:void(0)"
                        (click)="
                          submitQueryRequest(
                            'ForceScheduleCreation',
                            'This will create repayment schedules for all disbursed loans...Are you sure you want to proceed'
                          )
                        "
                        class="dt-card__more"
                        >Click to Force Repayment Schedule Creation
                        <i class="ml-2 icon icon-long-arrow-right icon-xl"></i
                      ></a>
                      <span><small></small></span>
                      <!-- <small>Disbursed Loans Without Schedules</small> -->
                    </label>
                  </div>

                  <div class="checkbox switcher">
                    <label for="test1">
                      <i class="mr-5 icon icon-setting icon-spin icon-xs"></i>
                      <a
                        href="javascript:void(0)"
                        (click)="
                          submitQueryRequest(
                            'PaymentReconciliationEvent',
                            'This will reconcile payments for all Loans...Are you sure you want to proceed'
                          )
                        "
                        class="dt-card__more"
                        >Click to Force Payment Reconciliation Event
                        <i class="ml-2 icon icon-long-arrow-right icon-xl"></i
                      ></a>
                      <span><small></small></span>
                      <!-- <small>Reconcile Payments to Schedules</small> -->
                    </label>
                  </div>

                  <hr class="fainted" />
                </div>
              </div>
              <!-- /button group -->
            </section>
            <!-- /section -->
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->

        <!-- Card -->
        <!-- <div class="card"> -->

        <!-- Card Body -->
        <!-- <div class="card-body">
                        <h2 class="card-title">Another Card</h2>
                    </div> -->
        <!-- /card body -->

        <!-- </div> -->
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="tab-pane--1" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-4 d-none order-xl-2">
        <!-- Grid -->
        <div class="row">
          <!-- Grid Item -->
          <div class="col-xl-12 col-md-6 col-12 order-xl-1">
            <!-- Card -->
            <div class="dt-card dt-card__full-height">
              <!-- Card Header -->
              <div class="dt-card__header">
                <!-- Card Heading -->
                <div class="dt-card__heading">
                  <h3 class="dt-card__title">Support</h3>
                </div>
                <!-- /card heading -->
              </div>
              <!-- /card header -->

              <!-- Card Body -->
              <div class="dt-card__body">
                <!-- Media -->
                <div class="mb-5 media">
                  <i class="mr-5 icon icon-email icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12">Mail</span>
                    <a href="javascript:void(0)">info@lenda.com</a>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->

                <!-- Media -->
                <div class="mb-5 media">
                  <i class="mr-5 icon icon-link icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12"
                      >Web Page</span
                    >
                    <a href="javascript:void(0)">lenda.com</a>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->

                <!-- Media -->
                <div class="media">
                  <i class="mr-5 icon icon-phone icon-xl"></i>

                  <!-- Media Body -->
                  <div class="media-body">
                    <span class="mb-1 d-block text-light-gray f-12">Phone</span>
                    <span class="h5 orange">+234 01 8390923</span>
                  </div>
                  <!-- /media body -->
                </div>
                <!-- /media -->
              </div>
              <!-- /card body -->
            </div>
            <!-- /card -->
          </div>
          <!-- /grid item -->
        </div>
        <!-- /grid -->
      </div>
      <!-- /grid item -->

      <!-- Grid Item -->
      <div class="col-xl-8 offset-xl-2 order-xl-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Notifications</h2>
          </div>
          <!-- /card header -->
          <!-- Card Body -->
          <div class="dt-card__body tabs-container tabs-vertical">
            <form
              [formGroup]="notificationForm"
              action=""
              method="post"
              (ngSubmit)="notificationFormSave(notificationForm.value)"
            >
              <div class="form-group">
                <label for="duration"
                  >How long before notification is triggered for application in
                  pool???</label
                >
                <div class="input-group">
                  <input
                    type="number"
                    formControlName="Duration"
                    id="duration"
                    class="form-control"
                  />
                  <div class="input-group-append">
                    <span class="input-group-text" id="basic-addon2"
                      >Minutes</span
                    >
                  </div>
                </div>
              </div>
              <div class="form-group">
                <button
                  type="submit"
                  class="btn btn-warning"
                  *ngIf="!keyLoader"
                  [disabled]="notificationForm.invalid"
                >
                  Save
                </button>
                <button
                  type="button"
                  class="btn btn-warning"
                  *ngIf="keyLoader"
                  [disabled]="true"
                >
                  <i class="icon icon-spin icon-spin2"></i>
                </button>
              </div>
            </form>
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
        <!-- Card -->
        <!-- <div class="card"> -->
        <!-- Card Body -->
        <!-- <div class="card-body">
                          <h2 class="card-title">Another Card</h2>
                        </div> -->
        <!-- /card body -->
        <!-- </div> -->
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="tab-pane-6" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-10 offset-md-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Loan Setup</h2>
          </div>
          <!-- /card header -->
          <!-- Card Body -->
          <div
            class="pb-2 card-body"
            *ngIf="
              appOwner != null &&
              user?.permission?.includes('Manage Business Information')
            "
          >
            <!-- <h4 class="text-center orange">Edit your profile</h4>-->
            <!-- Form -->
            <form [formGroup]="loanSetupForm" (ngSubmit)="updateLoanSetup()">
              <div class="form-row">
                <div class="mb-3 col-md-4">
                  <label for="validationDefault02"
                    >Loan Code <sup class="text-danger">*</sup></label
                  >
                  <input
                    type="text"
                    formControlName="appOwnerLoanCode"
                    class="form-control"
                    id="validationDefault02"
                    placeholder="Loan code"
                  />
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefault01"
                    >Loan Application Code
                    <sup class="text-danger">*</sup></label
                  >
                  <input
                    type="text"
                    formControlName="appOwnerLoanApplicationCode"
                    class="form-control"
                    id="validationDefault01"
                    placeholder="Loan Application Code"
                  />
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefaultdob"
                    >Loan Batch Code <sup class="text-danger">*</sup></label
                  >
                  <input
                    type="text"
                    formControlName="appOwnerLoanBatchCode"
                    class="form-control"
                    id="validationDefault02"
                    placeholder="Loan Batch Code"
                  />
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefault02" class="left-aligned"
                    >Loan Disbursement Code</label
                  >
                  <input
                    type="text"
                    formControlName="appOwnerLoanDisbursementCode"
                    class="form-control"
                    id="validationDefault02"
                    placeholder="Loan Disbursement Code"
                  />
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefault02" class="left-aligned"
                    >Loan Payment Code</label
                  >
                  <input
                    type="text"
                    formControlName="appOwnerLoanPaymentCode"
                    class="form-control"
                    id="validationDefault02"
                    placeholder="Loan Payment Code"
                  />
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefault02" class="left-aligned"
                    >Customer Loan Submission Type</label
                  >
                  <select
                    formControlName="customerLoanSubmissionType"
                    class="form-control"
                  >
                    <option disabled selected value="">-- Select --</option>
                    <option value="0">Pool</option>
                    <option value="1">Team Lead</option>
                  </select>
                </div>
                <div class="mb-3 col-md-4">
                  <label for="validationDefaultdob"
                    >Customer Identifier <sup class="text-danger">*</sup>

                    <span
                      ><i
                        class="icon icon-question-circle icon-fw icon-xl"
                        placement="top"
                        ngbTooltip="Unique identifier for your customers on the platform. This will have an effect when booking new loan applications"
                      ></i
                    ></span>
                  </label>
                  <select
                    formControlName="appOwnerLoanOriginationId"
                    class="form-control"
                  >
                    <option value="UNIQUE_ID">Unique ID</option>
                    <option value="EMAIL_ADDRESS">Email Address</option>
                    <option value="UNIQUE_ID_OR_EMAIL_ADDRESS">
                      Unique ID or Email Address
                    </option>
                  </select>
                </div>

                <div class="mb-3 col-md-4">
                  <label for="validationDefaultdob"
                    >Bank Vefrification<sup class="text-danger">*</sup>

                    <span
                      ><i
                        class="icon icon-question-circle icon-fw icon-xl"
                        placement="top"
                        ngbTooltip="Should validation of bank account be optional during loan applications"
                      ></i
                    ></span>
                  </label>
                  <select
                    formControlName="appOwnerLoanBankAccountValidationSetting"
                    class="form-control"
                  >
                    <option value="true">Enforce Verification</option>
                    <option value="false">Skip Verification</option>
                  </select>
                </div>

                <div class="mb-3 col-md-4">
                  <label for="fields"
                    >Customer Account Creation
                    <span
                      ><i
                        class="icon icon-question-circle icon-fw icon-xl"
                        placement="top"
                        ngbTooltip="Specify required fields in alternative customer creation section on loan creation."
                      ></i></span
                  ></label>
                  <angular2-multiselect
                    [data]="customerField"
                    selected="dataFieldSelected"
                    [settings]="dropdownSettings"
                    formControlName="uniqueIdInformation"
                    placeholder="No form field Selected"
                    (onSelect)="onCustomerItemSelect($event)"
                    (onDeSelect)="OnCustomerItemDeSelect($event)"
                    (onSelectAll)="onCustomerSelectAll($event)"
                    (onDeSelectAll)="onCustomerDeSelectAll($event)"
                    (onOpen)="toggleOpened($event)"
                  >
                  </angular2-multiselect>
                </div>

                <div class="mb-3 col-md-12 form-group">
                  <label for="fields">Loan Application Form Fields</label>
                  <angular2-multiselect
                    [data]="dataFields"
                    selected="dataFieldSelected"
                    [settings]="dropdownSettings"
                    formControlName="fieldModel"
                    placeholder="No form field Selected"
                    (onSelect)="onItemSelect($event)"
                    (onDeSelect)="OnItemDeSelect($event)"
                    (onSelectAll)="onSelectAll($event)"
                    (onDeSelectAll)="onDeSelectAll($event)"
                    (onOpen)="toggleOpened($event)"
                  >
                  </angular2-multiselect>
                </div>
              </div>

              <button
                [style.backgroundColor]="currentTheme?.secondaryColor"
                [style.borderColor]="currentTheme?.secondaryColor"
                class="mt-3 mb-3 btn btn-primary orange-bg"
                type="submit"
                *ngIf="!loader"
                [disabled]="loanSetupForm.invalid"
              >
                Update Setup
              </button>
              <button
                class="mt-3 mb-3 btn btn-primary orange-bg"
                type="button"
                *ngIf="loader"
                [disabled]="true"
              >
                <i class="icon icon-spin icon-spin2"></i> Updating ...
              </button>
            </form>
            <!-- /form -->
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="tab-pane-7" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-10 offset-md-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Disbursement Setup</h2>
          </div>
          <!-- /card header -->
          <!-- Card Body -->
          <div class="pb-2 card-body" *ngIf="appOwner != null">
            <!-- <h4 class="text-center orange">Edit your profile</h4>-->
            <!-- Form -->
            <form
              [formGroup]="loanDisbursmentForm"
              (ngSubmit)="updateDisbursementSetup()"
            >
              <div class="form-row">
                <div class="mb-3 col-md-4">
                  <label for="validationDefault02" class="left-aligned"
                    >Disbursement Failed Action</label
                  >
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="Determines what happens to a loan application once a disbursement attempt fails"
                    ></i
                  ></span>

                  <slct-2
                    [multiple]="false"
                    placeholder="Select Disbursement Action"
                    [data]="retryOptions"
                    formControlName="retryOptionObj"
                  ></slct-2>
                </div>

                <div
                  *ngIf="loanDisbursmentForm.value.retryOption === 'AllowRetry'"
                  class="mb-3 col-md-4"
                >
                  <label for="validationDefault01">Max Retrials Allowed</label>
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="Limits the number of times an application can be retried for disbursement. Once the set number is reached, the application is automatically sent back for a bank information update"
                    ></i
                  ></span>

                  <input
                    type="number"
                    formControlName="retryCount"
                    class="form-control"
                    id="validationDefault01"
                    placeholder="Enter Value"
                  />
                </div>

                <div class="mb-3 col-md-4">
                  <label for="validationDefault02" class="left-aligned"
                    >Update Complete Action</label
                  >
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="Controls action for where the loan application goes once the bank/funding account update has been performed. If Send for Approval is selected, responsible user with the Permission name APPROVE BANK ACCOUNT UPDATE will need to approve the change before it can be disbursed."
                    ></i
                  ></span>

                  <!-- <select formControlName="updateAction" class="form-control">
                    <option disabled selected value="">-- Select --</option>
                    <option value="0">Send For Approval</option>
                    <option value="1">Send For Disbursement</option>
                  </select> -->
                  <slct-2
                    [multiple]="false"
                    placeholder="Select Update Complete Action"
                    [data]="updateOptions"
                    formControlName="updateActionObj"
                  ></slct-2>
                </div>

                <div class="mb-3 col-md-4">
                  <label for="validationDefault01"
                    >Reminders For Failed Disbursements</label
                  >
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="The number of times you get reminded (via email) of a failed disbursement"
                    ></i
                  ></span>

                  <input
                    type="number"
                    formControlName="remindersAfterFailureCount"
                    class="form-control"
                    id="validationDefault01"
                    placeholder="Enter Value"
                    max="3"
                  />
                </div>
              </div>

              <button
                [style.backgroundColor]="currentTheme?.secondaryColor"
                [style.borderColor]="currentTheme?.secondaryColor"
                class="mt-3 mb-3 btn btn-primary orange-bg"
                type="submit"
                *ngIf="!loader"
                [disabled]="loanSetupForm.invalid"
              >
                Update Setup
              </button>
              <button
                class="mt-3 mb-3 btn btn-primary orange-bg"
                type="button"
                *ngIf="loader"
                [disabled]="true"
              >
                <i class="icon icon-spin icon-spin2"></i> Updating ...
              </button>
            </form>
            <!-- /form -->
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div
    *ngIf="
      user.permission?.includes('View Loan Disbursement Group') ||
      user.permission?.includes('View Loan Disbursement Limit') ||
      user.permission?.includes('View Loan Disbursement Limit Notification')
    "
    id="disb-limit"
    class="tab-pane"
  >
    <lnd-disbursement-limits />
  </div>

  <div id="tab-pane-9" class="tab-pane active">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-4 d-none order-xl-2">
        <!-- Grid -->

        <!-- /grid -->
      </div>
      <!-- /grid item -->

      <!-- Grid Item -->
      <div class="col-xl-8 offset-xl-2 order-xl-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <!-- <h2 class="mb--20">Access Links    </h2> -->
            <small>
              <i class="mr-5 icon icon-alert-new icon-xl"></i>Click on any of
              the access link to copy to clipboard</small
            >
          </div>
          <!-- /card header -->

          <div *ngIf="!isProductSetup" class="form-group">
            <div
              class="alert alert-warning alert-dismissible fade show"
              role="alert"
            >
              <i class="icon icon-alert"></i> To see your customer registration
              link, kindly setup loan products.
              <a
                *ngIf="user?.permission?.includes('View Loan Types')"
                routerLink="/configurations/loantypes"
                routerLinkActive="active"
                href="javascript:void(0)"
              >
                click here to setup now
              </a>
              <button
                type="button"
                class="close"
                data-dismiss="alert"
                aria-label="Close"
              >
                <span aria-hidden="true">×</span>
              </button>
            </div>
          </div>

          <!-- Card Body -->
          <div
            *ngIf="isProductSetup"
            class="dt-card__body tabs-container tabs-vertical"
          >
            <div class="form-group">
              <small>
                <b
                  >Loan Application/Customer Registration
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="Give this link to new customers to apply and register for new loan."
                    ></i></span></b
              ></small>
              <br /><br />
              <!-- <label for="duration" title="Click here to copy link to clipboard"  class="clickable"
                (click)="copyToClipboard(appOwner?.customerRegistrationUrl)">Using your buinsess key: <small
                 >{{appOwner?.customerRegistrationUrl}}</small></label> -->
              <br />
              <span
                *ngIf="
                  appOwner?.customerRegistrationUrlViaBusinessAlias != null
                "
              >
                <label
                  for="duration"
                  title="Click here to copy link to clipboard"
                  class="clickable"
                  (click)="
                    copyToClipboard(
                      appOwner?.customerRegistrationUrlViaBusinessAlias
                    )
                  "
                  >{{
                    appOwner?.customerRegistrationUrlViaBusinessAlias
                  }}</label
                >
              </span>
            </div>
            <hr style="border-top: 1px dashed rgba(0, 0, 0, 0.1)" />
            <div class="form-group">
              <small>
                <b>
                  Customer Portal
                  <span
                    ><i
                      class="icon icon-question-circle icon-fw icon-xl"
                      placement="top"
                      ngbTooltip="Give this link to existing customers to login to their dashboard and manage/apply for loans."
                    ></i></span></b
              ></small>
              <br /><br />
              <!-- <label for="duration" title="Click here to copy link to clipboard"
                (click)="copyToClipboard(appOwner?.customerPortalUrl)">Using your buinsess key: <small
                  class="clickable">{{appOwner?.customerPortalUrl}}</small></label> -->
              <span *ngIf="appOwner?.customerPortalUrlViaBusinessAlias != null">
                <label
                  for="duration"
                  title="Click here to copy link to clipboard"
                  class="clickable"
                  (click)="
                    copyToClipboard(appOwner?.customerPortalUrlViaBusinessAlias)
                  "
                  >{{ appOwner?.customerPortalUrlViaBusinessAlias }}</label
                >
              </span>
            </div>
            <div *ngIf="hasActiveUssdLoanType">
              <hr style="border-top: 1px dashed rgba(0, 0, 0, 0.1)" />
              <div class="form-group">
                <small> <b> Ussd Portal:</b></small> <br /><br />
                <label
                  for="duration"
                  title="Click here to copy link to clipboard"
                  (click)="copyToClipboard(ussdLoanCode)"
                  ><small class="clickable">{{ ussdLoanCode }}</small></label
                >
              </div>
            </div>
            <div
              *ngIf="
                !hasActiveUssdLoanType &&
                user?.permission?.includes('Manage USSD')
              "
            >
              <hr style="border-top: 1px dashed rgba(0, 0, 0, 0.1)" />
              <div class="form-group">
                <small>
                  <b>
                    Go to the next tab and set an active ussd loan type to
                    activate ussd.</b
                  ></small
                >
                <br /><br />
              </div>
            </div>
            <!--
              <hr>
              <textarea class="border-0 form-control h-100" disabled>
                <button>Sign Up</button>
              </textarea> -->
          </div>
          <!-- /card body -->
        </div>
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="tab-pane-10" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-10 offset-md-1">
        <!-- Card -->
        <div class="card">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Ussd Setup</h2>
          </div>
          <!-- /card header -->

          <!-- Card Body -->
          <div class="pb-2 card-body" *ngIf="appOwner != null">
            <!-- <h4 class="text-center orange">Edit your profile</h4>-->
            <!-- Form -->
            <div
              *ngIf="requestLoader"
              class="table-loader"
              style="text-align: center; color: indianred"
            >
              <span> <i class="icon icon-spin icon-spin2"></i> Loading...</span>
            </div>

            <div class="row" *ngIf="isEnterprise">
              <div class="mb-3 col-md-12">
                <form
                  *ngIf="setUssdShortCodePrefixForm"
                  [formGroup]="setUssdShortCodePrefixForm"
                  (ngSubmit)="setUssdShortCodePrefix()"
                >
                  <div class="form-row">
                    <div>
                      <label
                        >Ussd Short Code Prefix<sup class="text-danger"
                          >*</sup
                        ></label
                      >
                      <input
                        type="text"
                        formControlName="ussdShortCode"
                        class="form-control"
                        placeholder="Code"
                      />
                    </div>
                  </div>

                  <button
                    [style.backgroundColor]="currentTheme?.secondaryColor"
                    [style.borderColor]="currentTheme?.secondaryColor"
                    class="mt-3 mb-3 btn btn-primary orange-bg"
                    type="submit"
                    *ngIf="!ussdShortCodeLoader"
                    [disabled]="setUssdShortCodePrefixForm.invalid"
                  >
                    Update Setup
                  </button>
                  <button
                    class="mt-3 mb-3 btn btn-primary orange-bg"
                    type="button"
                    *ngIf="ussdShortCodeLoader"
                    [disabled]="true"
                  >
                    <i class="icon icon-spin icon-spin2"></i> Updating ...
                  </button>
                </form>
              </div>
            </div>

            <hr style="border-top: 1px dashed rgba(0, 0, 0, 0.1)" />

            <div class="row" *ngIf="ussdServicesLoaded && !requestLoader">
              <div class="mb-3 col-md-6">
                <label> Active Ussd Loan Type: </label>
                <span *ngIf="hasActiveUssdLoanType">
                  <b> {{ activeUssdLoanType.loanName }} </b>
                </span>
                <span class="text-danger" *ngIf="!hasActiveUssdLoanType">
                  Inactive</span
                >
              </div>
              <div class="mb-3 col-md-6">
                <label>Active Ussd Loan Offer: </label>
                <span *ngIf="hasDefaultLoanOffer">
                  <b>
                    {{ defaultLoanOffer.name }}:
                    {{
                      defaultLoanOffer?.loanAmount?.toLocaleString(undefined, {
                        minimumFractionDigits: 2
                      })
                    }}
                  </b>
                </span>

                <span class="text-danger" *ngIf="!hasDefaultLoanOffer">
                  Not Set</span
                >
              </div>
            </div>

            <hr style="border-top: 1px dashed rgba(0, 0, 0, 0.1)" />

            <div class="row" *ngIf="ussdServicesLoaded && !requestLoader">
              <div *ngIf="ussdLoanTypes.length > 0" class="mb-3 col-md-6">
                <label>
                  <span *ngIf="!hasActiveUssdLoanType">Set</span>
                  <span *ngIf="hasActiveUssdLoanType">Change</span>
                  Active Ussd Loan Type</label
                >
                <slct-2
                  [data]="ussdLoanTypes"
                  (selected)="onSelectActiveLoanType($event)"
                  [(ngModel)]="ngselectedLoanTypeId"
                  [ngModelOptions]="{ standalone: true }"
                  placeholder="Select Active Loan Type"
                ></slct-2>
              </div>
              <div *ngIf="ussdLoanTypes.length < 1" class="form-group col-md-6">
                <div
                  class="alert alert-warning alert-dismissible fade show"
                  role="alert"
                >
                  <i class="icon icon-alert"></i> You need to add the USSD
                  service as an applicable platform under loan types.
                  <a
                    *ngIf="
                      user?.permission?.includes('Create Loan Types') ||
                      user?.permission?.includes('Update Loan Types')
                    "
                    routerLink="/configurations/loantypes"
                    routerLinkActive="active"
                    href="javascript:void(0)"
                  >
                    Click here to setup now
                  </a>
                  <button
                    type="button"
                    class="close"
                    data-dismiss="alert"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">×</span>
                  </button>
                </div>
              </div>
              <div
                *ngIf="
                  loanOffersSelect.length > 0 && selectedLoanTypeId != null
                "
                class="mb-3 col-md-6"
              >
                <label>
                  <span *ngIf="!hasDefaultLoanOffer">Set</span>
                  <span *ngIf="hasDefaultLoanOffer">Change</span>
                  Active Ussd Loan Offer</label
                >
                <slct-2
                  [data]="loanOffersSelect"
                  (selected)="onSelectDefaultLoanOffer($event)"
                  placeholder="Select Active Loan Offer"
                  [(ngModel)]="ngselectedLoanOffer"
                  [ngModelOptions]="{ standalone: true }"
                ></slct-2>
                <br />
                <div *ngIf="selectedLoanOffer != null">
                  <label>Selected Loan Offer</label><br />
                  <label>Name:</label
                  ><input
                    type="text"
                    class="form-control"
                    value="{{ selectedLoanOffer?.name }}"
                    [readOnly]="true"
                  /><br />
                  <label>Amount:</label
                  ><input
                    type="text"
                    class="form-control"
                    currencyMask
                    [options]="{ prefix: '', thousands: ',', decimal: '.' }"
                    value="{{ selectedLoanOffer?.loanAmount }}"
                    [readOnly]="true"
                  /><br />
                  <label>Rate(%):</label
                  ><input
                    type="text"
                    class="form-control"
                    currencyMask
                    [options]="{ prefix: '', thousands: ',', decimal: '.' }"
                    value="{{ selectedLoanOffer?.interestRate }}"
                    [readOnly]="true"
                  /><br />
                </div>
              </div>
              <div
                *ngIf="loanOffersSelect.length < 1"
                class="form-group col-md-6"
              >
                <div
                  class="alert alert-warning alert-dismissible fade show"
                  role="alert"
                >
                  <i class="icon icon-alert"></i> You need to set loan offer for
                  the loan.
                  <a
                    *ngIf="user?.permission?.includes('Manage Loan Offers')"
                    routerLink="/configurations/parameterssetup"
                    routerLinkActive="active"
                    href="javascript:void(0)"
                  >
                    Click here to setup now
                  </a>
                  <button
                    type="button"
                    class="close"
                    data-dismiss="alert"
                    aria-label="Close"
                  >
                    <span aria-hidden="true">×</span>
                  </button>
                </div>
              </div>
            </div>

            <div
              class="text-right"
              *ngIf="ussdServicesLoaded && !requestLoader"
            >
              <button
                class="mt-3 mb-3 btn btn-xs btn-warning orange-bg"
                type="button"
                *ngIf="loader"
                [disabled]="true"
              >
                <i class="icon icon-spin icon-spin2"></i>Updating...
              </button>
              <button
                class="mt-3 mb-3 btn btn-xs btn-danger"
                type="button"
                *ngIf="!loader && hasActiveUssdLoanType"
                (click)="unsetActiveUssdLoanTypeAndOffer()"
              >
                Deactivate Ussd Service
              </button>

              <button
                class="mt-3 mb-3 btn btn-xs btn-claim"
                type="button"
                *ngIf="!loader && selectedLoanTypeId != null"
                (click)="setActiveUssdLoanTypeAndOffer()"
                [disabled]="selectedLoanTypeId == null"
              >
                Set Active
              </button>
              <button
                class="mt-3 mb-3 btn btn-xs cadet-lit orange-bg"
                type="button"
                *ngIf="loader"
                [disabled]="true"
              >
                <i class="icon icon-spin icon-spin2"></i>Updating...
              </button>
            </div>

            <div class="mb-3 col-md-4" *ngIf="hasActiveUssdLoanType">
              <!-- <label></label> -->
            </div>

            <!-- /form -->
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="tab-pane-11" class="tab-pane">
    <div class="row">
      <!-- Grid Item -->
      <div class="col-xl-6">
        <!-- Card -->
        <div class="card" style="min-height: 550px">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">Upload CSV or XLS</h2>
          </div>
          <!-- /card header -->
          <!-- Card Body -->
          <div class="pb-2 card-body">
            <div class="text-center">
              <img
                src="assets/images/loan-upload.svg"
                alt=""
                class="my-4 img-fluid"
              />
              <p class="mb-3">
                Upload a CSV or XLS file containing your bulk upload
                information.
                <br />
                Ensure it follows the sample template formating.
              </p>
              <p class="my-4">
                <i
                  title="Remove file"
                  (click)="removeFile()"
                  class="icon icon-trash text-danger pointer"
                  *ngIf="fileInput !== null"
                ></i>
                {{ fileInputLabel || "Choose File" }}
              </p>

              <button
                (click)="upload.click()"
                *ngIf="fileInput === null"
                class="px-4 ml-2 btn btn-primary btn-sm font-size-base"
              >
                Select Excel File
              </button>
              <input
                type="file"
                #upload
                hidden
                accept=".xlsx"
                (change)="onFileSelect($event)"
              />

              <div class="form-group my-3" *ngIf="fileInput !== null">
                <label>What bulk action are you performing ?</label>
                <select
                  class="form-control mx-auto w-50"
                  [(ngModel)]="bulkOperationType"
                >
                  <option value="null">Select action</option>
                  <option value="loan">Bulk Loan Upload</option>
                  <option value="tenor">Bulk Loan Tenor Upload</option>
                </select>
              </div>

              <button
                class="mt-3 mb-3 btn btn-primary orange-bg"
                (click)="uploadEvents()"
                *ngIf="!uploading && fileInput !== null"
                [disabled]="bulkOperationType === null"
              >
                Upload
                {{
                  bulkOperationType === "loan"
                    ? "Bulk Loans"
                    : bulkOperationType === "tenor"
                    ? "Bulk Loan Tenors"
                    : "File"
                }}
              </button>
              <button
                class="mt-3 mb-3 btn btn-primary orange-bg"
                *ngIf="uploading"
                disabled
              >
                Uploading <i class="icon icon-spin icon-spin2"></i>
              </button>
            </div>
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
      </div>
      <!-- /grid item -->
      <!-- Grid Item -->
      <div class="col-xl-6">
        <!-- Card -->
        <div class="card" style="min-height: 550px">
          <!-- Card Header -->
          <div
            class="bg-transparent card-header card-nav d-flex justify-content-between"
          >
            <h2 class="mb--20">How to Upload</h2>
          </div>
          <!-- /card header -->
          <!-- Card Body -->
          <div class="py-2 card-body">
            <div class="text-center">
              <img
                src="assets/images/filing.svg"
                alt=""
                class="my-4 img-fluid w-50"
              />
              <p class="mb-3">
                The Application allows an upload of up to two loan applications.
                <br />
                <br />
                Download the sample template for a guide on formating your data
                properly, format your application information into the CSV or
                XLS format and proceed to upload. Click the template you want to
                download below.
              </p>
              <button
                [style.backgroundColor]="currentTheme?.secondaryColor"
                [style.borderColor]="currentTheme?.secondaryColor"
                class="mt-3 mb-3 btn btn-primary orange-bg"
                (click)="downloadLoanTemplate()"
                *ngIf="!downloading"
              >
                Bulk loans template
              </button>
              <button
                [style.backgroundColor]="currentTheme?.secondaryColor"
                [style.borderColor]="currentTheme?.secondaryColor"
                class="mt-3 mb-3 btn ml-3 btn-primary orange-bg"
                (click)="downloadLoanUpdateTemplate()"
                *ngIf="!downloading"
              >
                Bulk Tenor Update template
              </button>
              <button
                class="mt-3 mb-3 btn btn-primary orange-bg"
                disabled
                *ngIf="downloading"
              >
                Downloading <i class="icon icon-spin icon-spin2"></i>
              </button>
            </div>
          </div>
          <!-- /card body -->
        </div>
        <!-- /card -->
      </div>
      <!-- /grid item -->
    </div>
  </div>

  <div id="multi-loan" class="tab-pane">
    <div class="row">
      <div class="col-xl-10 offset-md-1">
        <div class="card">
          <span
            *ngIf="requestLoader"
            [style.color]="currentTheme?.secondaryColor"
            class="d-flex justify-content-center p-5"
            >Processing... <i class="icon icon-spin icon-spin2"></i
          ></span>
          <section *ngIf="!requestLoader">
            <div
              class="bg-transparent card-header card-nav d-flex justify-content-between"
            >
              <h2 class="mb--20">Multi Loan Configuration</h2>
            </div>
            <div class="pb-2 card-body">
              <p>Enable concurrent loan products here</p>

              <div
                id="multi-loan-wrapper"
                [style.borderColor]="currentTheme?.secondaryColor"
              >
                <div id="multi-loan-form-config" *ngIf="!requestLoader">
                  <header class="d-flex justify-content-between mb-4">
                    <div class="d-flex align-items-center">
                      <lnd-switch
                        [value]="multiLoanIsActive"
                        (emittedValue)="setMultiLoanActiveState($event)"
                      ></lnd-switch>
                      <span *ngIf="!loader" class="ml-3"
                        >Multi loan Configuration is currently
                        <span
                          [ngClass]="
                            multiLoanIsActive ? 'text-success' : 'text-danger'
                          "
                          >{{ multiLoanIsActive ? "Active" : "Inactive" }}</span
                        >
                      </span>

                      <span
                        *ngIf="loader"
                        class="ml-3"
                        [style.color]="currentTheme?.secondaryColor"
                        >{{
                          multiLoanIsActive ? "Deactivating" : "Activating"
                        }}... <i class="icon icon-spin icon-spin2"></i
                      ></span>
                    </div>
                    <button
                      class="btn add-btn btn-xs"
                      (click)="toggleProductPopup('add')"
                      [disabled]="!multiLoanIsActive"
                    >
                      + Add new product
                    </button>
                  </header>

                  <lnd-table-header
                    *ngIf="multiLoanIsActive"
                    [pagination]="pagination"
                    [currentTheme]="currentTheme"
                    [isLoading]="requestLoader"
                    (paginationChange)="getMultiLoanConfigs($event)"
                    placeholder="Name"
                  ></lnd-table-header>

                  <p
                    *ngIf="!loader && multiLoanConfigs.length === 0"
                    class="text-center mt-5"
                  >
                    There are currently no loan product configurations
                  </p>

                  <table
                    *ngIf="
                      !loader &&
                      multiLoanConfigs.length > 0 &&
                      multiLoanIsActive
                    "
                    class="table"
                  >
                    <thead>
                      <th>Loan Type</th>
                      <th>Max Accounts</th>
                      <th>Allow Concurrent</th>
                      <th>Action</th>
                    </thead>

                    <tbody>
                      <tr *ngFor="let config of multiLoanConfigs">
                        <td>{{ config?.name }}</td>
                        <td>{{ config?.maxActiveLoanPerCustomer }}</td>
                        <td>{{ config?.allowConcurrency ? "Yes" : "No" }}</td>
                        <td>
                          <div class="dropdown mr-2 mb-2 d-inline-block">
                            <button
                              class="btn btn-warning btn-xs dropdown-toggle"
                              type="button"
                              data-toggle="dropdown"
                              aria-haspopup="true"
                              aria-expanded="false"
                            ></button>

                            <div class="dropdown-menu">
                              <a
                                class="dropdown-item cursor"
                                (click)="
                                  toggleProductPopup('edit', config?.loanTypeId)
                                "
                                ><i class="icon icon-edit icon-fw mr-2"></i
                                >Edit</a
                              >

                              <a
                                (click)="
                                  deleteMultiLoanConfig(config?.loanTypeId)
                                "
                                class="dropdown-item cursor"
                                ><i class="icon icon-trash icon-fw mr-2"></i
                                >Delete</a
                              >
                            </div>
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>

                  <lnd-table-footer
                    *ngIf="multiLoanIsActive"
                    [pagination]="pagination"
                    (paginationChange)="getMultiLoanConfigs($event)"
                  ></lnd-table-footer>
                </div>
              </div>
            </div>
          </section>
        </div>
      </div>
    </div>
  </div>

  <div id="notifications" class="tab-pane">
    <lnd-notifications
      [primaryColor]="currentTheme?.primaryColor"
    ></lnd-notifications>
  </div>

  <!-- /profile content -->
</div>

<lnd-popup
  title="Loan Product Configuration"
  type="report"
  [togglePopup]="togglePopup"
  (closePopup)="togglePopup = !togglePopup"
>
  <form
    id="multi-loan-form"
    [formGroup]="multiLoanForm"
    (ngSubmit)="submitMultiLoanConfig()"
    class="pop-content"
  >
    <div>
      <label for="loanType">Loan Type</label>
      <slct-2
        id="loanType"
        formControlName="loanType"
        placeholder="Select Loan Type"
        [multiple]="false"
        [disabled]="multiLoanConfigState === 'edit' ? true : false"
        [customSearchEnabled]="true"
        [data]="loanTypes"
        [searchService]="getSearchLoanTypeService()"
        (searchResult)="updateDropdown($event)"
        [ngClass]="multiLoanConfigState === 'edit' ? 'selected-item' : ''"
      ></slct-2>
    </div>

    <div class="my-6">
      <label for="maxAcc">Set Max Account</label>
      <input
        type="number"
        class="form-control"
        formControlName="maxActiveLoanPerCustomer"
        id="maxAcc"
        min="1"
      />

      <div
        class="text-danger mt-3"
        *ngIf="multiLoanForm.get('maxActiveLoanPerCustomer').errors?.zeroValue"
      >
        <span>{{
          multiLoanForm.get("maxActiveLoanPerCustomer").errors?.zeroValue
        }}</span>
      </div>
    </div>

    <lnd-switch
      *ngIf="togglePopup"
      text="Allow Concurrent"
      [value]="multiLoanForm.get('allowConcurrency').value"
      (emittedValue)="setConcurrency($event)"
    ></lnd-switch>
  </form>

  <footer class="pop-footer d-flex justify-content-end">
    <button
      class="btn btn-light mr-3"
      type="button"
      (click)="togglePopup = false"
    >
      Cancel
    </button>

    <button
      class="btn text-white"
      [disabled]="multiLoanForm.invalid"
      [style.backgroundColor]="currentTheme?.secondaryColor"
      type="button"
      (click)="submitMultiLoanConfig()"
    >
      {{ requestLoader ? "Processing..." : "Save" }}
      <i *ngIf="requestLoader" class="icon icon-spin icon-spin2"></i>
    </button>
  </footer>
</lnd-popup>
